{"componentChunkName":"component---src-pages-deployments-quarkus-mdx","path":"/deployments/quarkus/","result":{"pageContext":{"frontmatter":{"title":"Deploy Storefront (Quarkus Version) locally on your machine","description":"Instructions to deploy storefront locally"},"relativePagePath":"/deployments/quarkus.mdx","titleType":"page","MdxNode":{"id":"fe9af0df-4f41-56d2-84e2-85c4657c2fb4","children":[],"parent":"8746578c-2f38-589b-b8ba-0b09773d21fd","internal":{"content":"---\ntitle: Deploy Storefront (Quarkus Version) locally on your machine\ndescription: Instructions to deploy storefront locally\n---\n\n## Introduction\n\nStorefront is a simple shopping application that displays a catalog of antique computing devices, where users can search and buy products. It has a Web interface, and it relies on BFF (Backend for Frontend) services to interact with the backend services.\n\n## Pre-requisites:\n\n* [Java](https://www.java.com/en/)\n\n* [Appsody](https://appsody.dev/)\n  - [Installing on MacOS](https://appsody.dev/docs/installing/macos)\n  - [Installing on Windows](https://appsody.dev/docs/installing/windows)\n  - [Installing on RHEL](https://appsody.dev/docs/installing/rhel)\n  - [Installing on Ubuntu](https://appsody.dev/docs/installing/ubuntu)\n\nFor more details on installation, check [this](https://appsody.dev/docs/installing/installing-appsody/) out.\n\n* Docker Desktop\n  - [Docker for Mac](https://docs.docker.com/docker-for-mac/)\n  - [Docker for Windows](https://docs.docker.com/docker-for-windows/)\n\n## Running the application locally\n\nLet us now deploy all the microservices of our storefront one by one locally.\n\n### Inventory\n\n- Clone inventory repository\n\n```bash\ngit clone https://github.com/ibm-garage-ref-storefront/inventory-ms-quarkus.git\ncd inventory-ms-quarkus\n```\n\n#### Deploy MySQL database\n\n<br></br>\n\n```\n# Start a MySQL Container with a database user, a password, and create a new database\ndocker run --name inventorymysql \\\n    -e MYSQL_ROOT_PASSWORD=admin123 \\\n    -e MYSQL_USER=dbuser \\\n    -e MYSQL_PASSWORD=password \\\n    -e MYSQL_DATABASE=inventorydb \\\n    -p 3306:3306 \\\n    -d mysql\n```\n\nIf it is successfully deployed, you will see something like below.\n\n```\n$ docker ps\nCONTAINER ID   IMAGE     COMMAND                  CREATED       STATUS       PORTS                               NAMES\ne87f041c7da7   mysql     \"docker-entrypoint.s…\"   2 hours ago   Up 2 hours   0.0.0.0:3306->3306/tcp, 33060/tcp   inventorymysql\n```\n\n- Now let us populate the MySQL with data.\n\nFirstly, `ssh` into the MySQL container.\n\n```\ndocker exec -it inventorymysql bash\n```\n\n- Now, run the below command for table creation.\n\n```\nmysql -udbuser -ppassword\n```\n\n- This will take you to something like below.\n\n```\nroot@e87f041c7da7:/# mysql -udbuser -ppassword\nmysql: [Warning] Using a password on the command line interface can be insecure.\nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 13\nServer version: 8.0.23 MySQL Community Server - GPL\n\nCopyright (c) 2000, 2021, Oracle and/or its affiliates.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nmysql>\n```\n\n- Go to `scripts > mysql_data.sql`. Copy the contents from [mysql_data.sql](https://github.com/ibm-garage-ref-storefront/inventory-ms-quarkus/blob/master/scripts/mysql_data.sql) and paste the contents in the console.\n\n- You can exit from the console using `exit`.\n\n```\nmysql> exit\nBye\n```\n\n- To come out of the container, enter `exit`.\n\n```\nroot@d88a6e5973de:/# exit\n```\n\n#### Deploy Inventory app\n\n<br></br>\n\nRun the below command.\n\n```\n# Package the application using native profile\n./mvnw package -Pnative -Dquarkus.native.container-build=true\n\n# Build the docker image\ndocker build -f src/main/docker/Dockerfile.native -t inventory-ms-quarkus-native .\n\n# Run the application\ndocker run -it -d --rm -e quarkus.datasource.jdbc.url=jdbc:mysql://host.docker.internal:3306/inventorydb?useSSL=true -e quarkus.datasource.username=dbuser -e quarkus.datasource.password=password -p 8082:8080 inventory-ms-quarkus-native\n```\n\n- You can also verify it as follows.\n\n```\n$ docker ps\nCONTAINER ID   IMAGE                                                 COMMAND                  CREATED       STATUS       PORTS                                            NAMES\nb50a1ad23fed   inventory-ms-quarkus-native                           \"./application -Dqua…\"   2 days ago    Up 2 days    0.0.0.0:8082->8080/tcp                           pedantic_murdock\n20c0472e885f   mysql                                                 \"docker-entrypoint.s…\"   2 days ago    Up 2 days    0.0.0.0:3306->3306/tcp, 33060/tcp                inventorymysql\n```\n\n### Catalog\n\n- Clone catalog repository\n\n```bash\ngit clone https://github.com/ibm-garage-ref-storefront/catalog-ms-quarkus.git\ncd catalog-ms-quarkus\n```\n\n#### Deploy ElasticSearch\n\n<br></br>\n\n```\n# Start an Elasticsearch Container\ndocker run --name catalogelasticsearch \\\n      -e \"discovery.type=single-node\" \\\n      -p 9200:9200 \\\n      -p 9300:9300 \\\n      -d docker.elastic.co/elasticsearch/elasticsearch:6.3.2\n```\n\nIf it is successfully deployed, you will see something like below.\n\n```\n$ docker ps\nCONTAINER ID   IMAGE                                                 COMMAND                  CREATED       STATUS       PORTS                                            NAMES\n6c27955669e2   docker.elastic.co/elasticsearch/elasticsearch:6.3.2   \"/usr/local/bin/dock…\"   2 days ago    Up 2 days    0.0.0.0:9200->9200/tcp, 0.0.0.0:9300->9300/tcp   catalogelasticsearch\nb50a1ad23fed   inventory-ms-quarkus-native                           \"./application -Dqua…\"   2 days ago    Up 2 days    0.0.0.0:8082->8080/tcp                           pedantic_murdock\n20c0472e885f   mysql                                                 \"docker-entrypoint.s…\"   2 days ago    Up 2 days    0.0.0.0:3306->3306/tcp, 33060/tcp                inventorymysql\n```\n\n#### Deploy Catalog app\n\n<br></br>\n\nRun the below command.\n\n```\n# Package the application using native profile\n./mvnw package -Pnative -Dquarkus.elasticsearch.hosts=http://localhost:9200 -Dibm.cn.application.client.InventoryServiceClient/mp-rest/url=http://localhost:8082/micro/inventory -Dquarkus.native.container-build=true\n\n# Build the docker image\ndocker build -f src/main/docker/Dockerfile.native -t catalog-ms-quarkus-native .\n\n# Run the application\ndocker run -it -d --rm -e quarkus.elasticsearch.hosts=http://host.docker.internal:9200 -e ibm.cn.application.client.InventoryServiceClient/mp-rest/url=http://host.docker.internal:8082/micro/inventory -p 8083:8080 catalog-ms-quarkus-native\n```\n\n- You can also verify it as follows.\n\n```\n$ docker ps\nCONTAINER ID   IMAGE                                                 COMMAND                  CREATED       STATUS       PORTS                                            NAMES\na5774b328b8d   catalog-ms-quarkus-native                             \"./application -Dqua…\"   2 days ago    Up 2 days    0.0.0.0:8083->8080/tcp                           inspiring_wozniak\n6c27955669e2   docker.elastic.co/elasticsearch/elasticsearch:6.3.2   \"/usr/local/bin/dock…\"   2 days ago    Up 2 days    0.0.0.0:9200->9200/tcp, 0.0.0.0:9300->9300/tcp   catalogelasticsearch\nb50a1ad23fed   inventory-ms-quarkus-native                           \"./application -Dqua…\"   2 days ago    Up 2 days    0.0.0.0:8082->8080/tcp                           pedantic_murdock\n20c0472e885f   mysql                                                 \"docker-entrypoint.s…\"   2 days ago    Up 2 days    0.0.0.0:3306->3306/tcp, 33060/tcp                inventorymysql\n```\n\n### Authentication using Keycloak\n\nKeycloak is used for storing users and authenticating users. To configure it, refer [Keycloak - JWT token generation](https://cloudnativereference.dev/related-repositories/keycloak/).\n\nMake sure you grab the `client_secret`. You need to pass it as a param in the below services.\n\n### Customer\n\n- Clone customer repository\n\n```bash\ngit clone https://github.com/ibm-garage-ref-storefront/customer-ms-quarkus.git\ncd customer-ms-quarkus\n```\n\n#### Deploy CouchDB\n\n<br></br>\n\n```\n# Start a CouchDB Container with a database user, and a password\ndocker run -d -e COUCHDB_USER='admin' -e COUCHDB_PASSWORD='password' -p 5984:5984 couchdb\n```\n\nIf it is successfully deployed, you will see something like below.\n\n```\n$ docker ps\nCONTAINER ID   IMAGE                                                 COMMAND                  CREATED       STATUS       PORTS                                            NAMES\n8b4430086226   couchdb                                               \"tini -- /docker-ent…\"   2 days ago    Up 2 days    4369/tcp, 9100/tcp, 0.0.0.0:5984->5984/tcp       angry_davinci\na5774b328b8d   catalog-ms-quarkus-native                             \"./application -Dqua…\"   2 days ago    Up 2 days    0.0.0.0:8083->8080/tcp                           inspiring_wozniak\n6c27955669e2   docker.elastic.co/elasticsearch/elasticsearch:6.3.2   \"/usr/local/bin/dock…\"   2 days ago    Up 2 days    0.0.0.0:9200->9200/tcp, 0.0.0.0:9300->9300/tcp   catalogelasticsearch\nb50a1ad23fed   inventory-ms-quarkus-native                           \"./application -Dqua…\"   2 days ago    Up 2 days    0.0.0.0:8082->8080/tcp                           pedantic_murdock\n20c0472e885f   mysql                                                 \"docker-entrypoint.s…\"   2 days ago    Up 2 days    0.0.0.0:3306->3306/tcp, 33060/tcp                inventorymysql\n1bdb13bf24cd   quay.io/keycloak/keycloak:12.0.2                      \"/opt/jboss/tools/do…\"   2 days ago    Up 2 days    8443/tcp, 0.0.0.0:8085->8080/tcp                 bold_elion\n```\n\n- Populate the database with user information.\n\n```\ncd populate\npython3 populate.py localhost 5984\ncd ..\n```\n\n#### Deploy Customer app\n\n<br></br>\n\nRun the below command.\n\n```\n# Package the application using native profile\n./mvnw package -Pnative -Dquarkus.native.container-build=true\n\n# Build the docker image\ndocker build -f src/main/docker/Dockerfile.native -t customer-ms-quarkus-native .\n\n# Run the application\ndocker run -it -d --rm -e ibm.cn.application.couchdb.client.CouchDBClientService/mp-rest/url=http://host.docker.internal:5984 -e couchuser=admin -e couchpassword=password -e quarkus.oidc.auth-server-url=http://host.docker.internal:8085/auth/realms/sfrealm -e quarkus.oidc.client-id=bluecomputeweb -e quarkus.oidc.credentials.secret=a297757d-d2cc-4921-8e66-971432a68826 -p 8087:8080 customer-ms-quarkus-native\n```\n\nNote: Set the `quarkus.oidc.credentials.secret` value to the value you grabbed earlier.\n\n- You can also verify it as follows.\n\n```\n$ docker ps\nCONTAINER ID   IMAGE                                                 COMMAND                  CREATED       STATUS       PORTS                                            NAMES\n4e0d5679fb92   customer-ms-quarkus-native                            \"./application -Dqua…\"   2 hours ago   Up 2 hours   0.0.0.0:8087->8080/tcp                           ecstatic_lumiere\n8b4430086226   couchdb                                               \"tini -- /docker-ent…\"   2 days ago    Up 2 days    4369/tcp, 9100/tcp, 0.0.0.0:5984->5984/tcp       angry_davinci\na5774b328b8d   catalog-ms-quarkus-native                             \"./application -Dqua…\"   2 days ago    Up 2 days    0.0.0.0:8083->8080/tcp                           inspiring_wozniak\n6c27955669e2   docker.elastic.co/elasticsearch/elasticsearch:6.3.2   \"/usr/local/bin/dock…\"   2 days ago    Up 2 days    0.0.0.0:9200->9200/tcp, 0.0.0.0:9300->9300/tcp   catalogelasticsearch\nb50a1ad23fed   inventory-ms-quarkus-native                           \"./application -Dqua…\"   2 days ago    Up 2 days    0.0.0.0:8082->8080/tcp                           pedantic_murdock\n20c0472e885f   mysql                                                 \"docker-entrypoint.s…\"   2 days ago    Up 2 days    0.0.0.0:3306->3306/tcp, 33060/tcp                inventorymysql\n1bdb13bf24cd   quay.io/keycloak/keycloak:12.0.2                      \"/opt/jboss/tools/do…\"   2 days ago    Up 2 days    8443/tcp, 0.0.0.0:8085->8080/tcp                 bold_elion\n```\n\n### Orders\n\n- Clone orders repository\n\n```bash\ngit clone https://github.com/ibm-garage-ref-storefront/orders-ms-quarkus.git\ncd orders-ms-quarkus\n```\n\n#### Deploy Mariadb\n\n<br></br>\n\n```\n# Start a MariaDB Container with a database user, a password, and create a new database\ndocker run --name ordersmysql \\\n    -e MYSQL_ROOT_PASSWORD=admin123 \\\n    -e MYSQL_USER=dbuser \\\n    -e MYSQL_PASSWORD=password \\\n    -e MYSQL_DATABASE=ordersdb \\\n    -p 3307:3306 \\\n    -d mariadb\n```\n\nIf it is successfully deployed, you will see something like below.\n\n```\n$ docker ps\nCONTAINER ID   IMAGE                                                 COMMAND                  CREATED       STATUS       PORTS                                            NAMES\n4e0d5679fb92   customer-ms-quarkus-native                            \"./application -Dqua…\"   2 hours ago   Up 2 hours   0.0.0.0:8087->8080/tcp                           ecstatic_lumiere\n8b4430086226   couchdb                                               \"tini -- /docker-ent…\"   2 days ago    Up 2 days    4369/tcp, 9100/tcp, 0.0.0.0:5984->5984/tcp       angry_davinci\n9d65ba050ad1   mariadb                                               \"docker-entrypoint.s…\"   2 days ago    Up 2 days    0.0.0.0:3307->3306/tcp                           ordersmysql\na5774b328b8d   catalog-ms-quarkus-native                             \"./application -Dqua…\"   2 days ago    Up 2 days    0.0.0.0:8083->8080/tcp                           inspiring_wozniak\n6c27955669e2   docker.elastic.co/elasticsearch/elasticsearch:6.3.2   \"/usr/local/bin/dock…\"   2 days ago    Up 2 days    0.0.0.0:9200->9200/tcp, 0.0.0.0:9300->9300/tcp   catalogelasticsearch\nb50a1ad23fed   inventory-ms-quarkus-native                           \"./application -Dqua…\"   2 days ago    Up 2 days    0.0.0.0:8082->8080/tcp                           pedantic_murdock\n20c0472e885f   mysql                                                 \"docker-entrypoint.s…\"   2 days ago    Up 2 days    0.0.0.0:3306->3306/tcp, 33060/tcp                inventorymysql\n1bdb13bf24cd   quay.io/keycloak/keycloak:12.0.2                      \"/opt/jboss/tools/do…\"   2 days ago    Up 2 days    8443/tcp, 0.0.0.0:8085->8080/tcp                 bold_elion\n```\n\n- Create the orders table.\n\nFirstly, `ssh` into the MariaDB container.\n\n```\ndocker exec -it ordersmysql bash\n```\n\n- Now, run the below command for table creation.\n\n```\nmysql -udbuser -ppassword\n```\n\n- This will take you to something like below.\n\n```\nroot@5762edb59a86:/# mysql -udbuser -ppassword\nWelcome to the MariaDB monitor.  Commands end with ; or \\g.\nYour MariaDB connection id is 22\nServer version: 10.5.5-MariaDB-1:10.5.5+maria~focal mariadb.org binary distribution\n\nCopyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nMariaDB [(none)]>\n```\n\n- Go to `scripts > mysql_data.sql`. Copy the contents from [mysql_data.sql](./scripts/mysql_data.sql) and paste the contents in the console.\n\n- You can exit from the console using `exit`.\n\n```\nMariaDB [(none)]> exit\nBye\n```\n\n- To come out of the container, enter `exit`.\n\n```\nroot@5762edb59a86:/# exit\n```\n\n#### Deploy Orders app\n\n<br></br>\n\nRun the below command.\n\n```\n# Package the application using native profile\n./mvnw package -Pnative -Dquarkus.native.container-build=true\n\n# Build the docker image\ndocker build -f src/main/docker/Dockerfile.native -t orders-ms-quarkus-native .\n\n# Run the application\ndocker run -it -d --rm -e quarkus.datasource.jdbc.url=jdbc:mysql://host.docker.internal:3307/ordersdb?useSSL=true -e quarkus.datasource.username=dbuser -e quarkus.datasource.password=password -e quarkus.oidc.auth-server-url=http://host.docker.internal:8085/auth/realms/sfrealm -e quarkus.oidc.client-id=bluecomputeweb -e quarkus.oidc.credentials.secret=a297757d-d2cc-4921-8e66-971432a68826 -p 8086:8080 orders-ms-quarkus-native\n```\n\nNote: Set the `quarkus.oidc.credentials.secret` value to the value you grabbed earlier.\n\n- You can also verify it as follows.\n\n```\n$ docker ps\nCONTAINER ID   IMAGE                                                 COMMAND                  CREATED       STATUS       PORTS                                            NAMES\n4e0d5679fb92   customer-ms-quarkus-native                            \"./application -Dqua…\"   2 hours ago   Up 2 hours   0.0.0.0:8087->8080/tcp                           ecstatic_lumiere\n8b4430086226   couchdb                                               \"tini -- /docker-ent…\"   2 days ago    Up 2 days    4369/tcp, 9100/tcp, 0.0.0.0:5984->5984/tcp       angry_davinci\nbc39c2469804   orders-ms-quarkus-native                              \"./application -Dqua…\"   2 days ago    Up 2 days    0.0.0.0:8086->8080/tcp                           dazzling_meitner\n9d65ba050ad1   mariadb                                               \"docker-entrypoint.s…\"   2 days ago    Up 2 days    0.0.0.0:3307->3306/tcp                           ordersmysql\na5774b328b8d   catalog-ms-quarkus-native                             \"./application -Dqua…\"   2 days ago    Up 2 days    0.0.0.0:8083->8080/tcp                           inspiring_wozniak\n6c27955669e2   docker.elastic.co/elasticsearch/elasticsearch:6.3.2   \"/usr/local/bin/dock…\"   2 days ago    Up 2 days    0.0.0.0:9200->9200/tcp, 0.0.0.0:9300->9300/tcp   catalogelasticsearch\nb50a1ad23fed   inventory-ms-quarkus-native                           \"./application -Dqua…\"   2 days ago    Up 2 days    0.0.0.0:8082->8080/tcp                           pedantic_murdock\n20c0472e885f   mysql                                                 \"docker-entrypoint.s…\"   2 days ago    Up 2 days    0.0.0.0:3306->3306/tcp, 33060/tcp                inventorymysql\n1bdb13bf24cd   quay.io/keycloak/keycloak:12.0.2                      \"/opt/jboss/tools/do…\"   2 days ago    Up 2 days    8443/tcp, 0.0.0.0:8085->8080/tcp                 bold_elion\n```\n\n### Storefront UI\n\n- Clone Storefront-UI repository\n\n```bash\ngit clone https://github.com/ibm-garage-ref-storefront/storefront-ui.git\ncd storefront-ui\ngit checkout hp-quarkus-version\n```\n\n#### Deploy Storefront UI\n\n<br></br>\n\n- Go to `config > default.json` and change the `client_secret` to the one you grabbed earlier from keycloak.\n\n- Run the below command.\n\n```\n# Build storefront ui docker image\nappsody build\n\n# Start the Storefront UI Container\ndocker run --name web \\\n  -e NODE_ENV=development \\\n  -p 3000:3000 \\\n  -d dev.local/web\n```\n\n- You can also verify it as follows.\n\n```\n$ docker ps\nCONTAINER ID   IMAGE                                                 COMMAND                  CREATED       STATUS       PORTS                                            NAMES\ne616793340c7   dev.local/web                                         \"container-entrypoin…\"   2 hours ago   Up 2 hours   0.0.0.0:3000->3000/tcp, 8080/tcp                 web\n4e0d5679fb92   customer-ms-quarkus-native                            \"./application -Dqua…\"   2 hours ago   Up 2 hours   0.0.0.0:8087->8080/tcp                           ecstatic_lumiere\n8b4430086226   couchdb                                               \"tini -- /docker-ent…\"   2 days ago    Up 2 days    4369/tcp, 9100/tcp, 0.0.0.0:5984->5984/tcp       angry_davinci\nbc39c2469804   orders-ms-quarkus-native                              \"./application -Dqua…\"   2 days ago    Up 2 days    0.0.0.0:8086->8080/tcp                           dazzling_meitner\n9d65ba050ad1   mariadb                                               \"docker-entrypoint.s…\"   2 days ago    Up 2 days    0.0.0.0:3307->3306/tcp                           ordersmysql\na5774b328b8d   catalog-ms-quarkus-native                             \"./application -Dqua…\"   2 days ago    Up 2 days    0.0.0.0:8083->8080/tcp                           inspiring_wozniak\n6c27955669e2   docker.elastic.co/elasticsearch/elasticsearch:6.3.2   \"/usr/local/bin/dock…\"   2 days ago    Up 2 days    0.0.0.0:9200->9200/tcp, 0.0.0.0:9300->9300/tcp   catalogelasticsearch\nb50a1ad23fed   inventory-ms-quarkus-native                           \"./application -Dqua…\"   2 days ago    Up 2 days    0.0.0.0:8082->8080/tcp                           pedantic_murdock\n20c0472e885f   mysql                                                 \"docker-entrypoint.s…\"   2 days ago    Up 2 days    0.0.0.0:3306->3306/tcp, 33060/tcp                inventorymysql\n1bdb13bf24cd   quay.io/keycloak/keycloak:12.0.2                      \"/opt/jboss/tools/do…\"   2 days ago    Up 2 days    8443/tcp, 0.0.0.0:8085->8080/tcp                 bold_elion\n```\n\nThere you go, you deploy all the necessary services for storefront.\n\nNow, let us check the app out. You can access it at http://localhost:3000.\n\n![Storefront](../../images/web.png)\n","type":"Mdx","contentDigest":"43e86832fa45a7ebb81b555f369eb90a","counter":114,"owner":"gatsby-plugin-mdx"},"frontmatter":{"title":"Deploy Storefront (Quarkus Version) locally on your machine","description":"Instructions to deploy storefront locally"},"exports":{},"rawBody":"---\ntitle: Deploy Storefront (Quarkus Version) locally on your machine\ndescription: Instructions to deploy storefront locally\n---\n\n## Introduction\n\nStorefront is a simple shopping application that displays a catalog of antique computing devices, where users can search and buy products. It has a Web interface, and it relies on BFF (Backend for Frontend) services to interact with the backend services.\n\n## Pre-requisites:\n\n* [Java](https://www.java.com/en/)\n\n* [Appsody](https://appsody.dev/)\n  - [Installing on MacOS](https://appsody.dev/docs/installing/macos)\n  - [Installing on Windows](https://appsody.dev/docs/installing/windows)\n  - [Installing on RHEL](https://appsody.dev/docs/installing/rhel)\n  - [Installing on Ubuntu](https://appsody.dev/docs/installing/ubuntu)\n\nFor more details on installation, check [this](https://appsody.dev/docs/installing/installing-appsody/) out.\n\n* Docker Desktop\n  - [Docker for Mac](https://docs.docker.com/docker-for-mac/)\n  - [Docker for Windows](https://docs.docker.com/docker-for-windows/)\n\n## Running the application locally\n\nLet us now deploy all the microservices of our storefront one by one locally.\n\n### Inventory\n\n- Clone inventory repository\n\n```bash\ngit clone https://github.com/ibm-garage-ref-storefront/inventory-ms-quarkus.git\ncd inventory-ms-quarkus\n```\n\n#### Deploy MySQL database\n\n<br></br>\n\n```\n# Start a MySQL Container with a database user, a password, and create a new database\ndocker run --name inventorymysql \\\n    -e MYSQL_ROOT_PASSWORD=admin123 \\\n    -e MYSQL_USER=dbuser \\\n    -e MYSQL_PASSWORD=password \\\n    -e MYSQL_DATABASE=inventorydb \\\n    -p 3306:3306 \\\n    -d mysql\n```\n\nIf it is successfully deployed, you will see something like below.\n\n```\n$ docker ps\nCONTAINER ID   IMAGE     COMMAND                  CREATED       STATUS       PORTS                               NAMES\ne87f041c7da7   mysql     \"docker-entrypoint.s…\"   2 hours ago   Up 2 hours   0.0.0.0:3306->3306/tcp, 33060/tcp   inventorymysql\n```\n\n- Now let us populate the MySQL with data.\n\nFirstly, `ssh` into the MySQL container.\n\n```\ndocker exec -it inventorymysql bash\n```\n\n- Now, run the below command for table creation.\n\n```\nmysql -udbuser -ppassword\n```\n\n- This will take you to something like below.\n\n```\nroot@e87f041c7da7:/# mysql -udbuser -ppassword\nmysql: [Warning] Using a password on the command line interface can be insecure.\nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 13\nServer version: 8.0.23 MySQL Community Server - GPL\n\nCopyright (c) 2000, 2021, Oracle and/or its affiliates.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nmysql>\n```\n\n- Go to `scripts > mysql_data.sql`. Copy the contents from [mysql_data.sql](https://github.com/ibm-garage-ref-storefront/inventory-ms-quarkus/blob/master/scripts/mysql_data.sql) and paste the contents in the console.\n\n- You can exit from the console using `exit`.\n\n```\nmysql> exit\nBye\n```\n\n- To come out of the container, enter `exit`.\n\n```\nroot@d88a6e5973de:/# exit\n```\n\n#### Deploy Inventory app\n\n<br></br>\n\nRun the below command.\n\n```\n# Package the application using native profile\n./mvnw package -Pnative -Dquarkus.native.container-build=true\n\n# Build the docker image\ndocker build -f src/main/docker/Dockerfile.native -t inventory-ms-quarkus-native .\n\n# Run the application\ndocker run -it -d --rm -e quarkus.datasource.jdbc.url=jdbc:mysql://host.docker.internal:3306/inventorydb?useSSL=true -e quarkus.datasource.username=dbuser -e quarkus.datasource.password=password -p 8082:8080 inventory-ms-quarkus-native\n```\n\n- You can also verify it as follows.\n\n```\n$ docker ps\nCONTAINER ID   IMAGE                                                 COMMAND                  CREATED       STATUS       PORTS                                            NAMES\nb50a1ad23fed   inventory-ms-quarkus-native                           \"./application -Dqua…\"   2 days ago    Up 2 days    0.0.0.0:8082->8080/tcp                           pedantic_murdock\n20c0472e885f   mysql                                                 \"docker-entrypoint.s…\"   2 days ago    Up 2 days    0.0.0.0:3306->3306/tcp, 33060/tcp                inventorymysql\n```\n\n### Catalog\n\n- Clone catalog repository\n\n```bash\ngit clone https://github.com/ibm-garage-ref-storefront/catalog-ms-quarkus.git\ncd catalog-ms-quarkus\n```\n\n#### Deploy ElasticSearch\n\n<br></br>\n\n```\n# Start an Elasticsearch Container\ndocker run --name catalogelasticsearch \\\n      -e \"discovery.type=single-node\" \\\n      -p 9200:9200 \\\n      -p 9300:9300 \\\n      -d docker.elastic.co/elasticsearch/elasticsearch:6.3.2\n```\n\nIf it is successfully deployed, you will see something like below.\n\n```\n$ docker ps\nCONTAINER ID   IMAGE                                                 COMMAND                  CREATED       STATUS       PORTS                                            NAMES\n6c27955669e2   docker.elastic.co/elasticsearch/elasticsearch:6.3.2   \"/usr/local/bin/dock…\"   2 days ago    Up 2 days    0.0.0.0:9200->9200/tcp, 0.0.0.0:9300->9300/tcp   catalogelasticsearch\nb50a1ad23fed   inventory-ms-quarkus-native                           \"./application -Dqua…\"   2 days ago    Up 2 days    0.0.0.0:8082->8080/tcp                           pedantic_murdock\n20c0472e885f   mysql                                                 \"docker-entrypoint.s…\"   2 days ago    Up 2 days    0.0.0.0:3306->3306/tcp, 33060/tcp                inventorymysql\n```\n\n#### Deploy Catalog app\n\n<br></br>\n\nRun the below command.\n\n```\n# Package the application using native profile\n./mvnw package -Pnative -Dquarkus.elasticsearch.hosts=http://localhost:9200 -Dibm.cn.application.client.InventoryServiceClient/mp-rest/url=http://localhost:8082/micro/inventory -Dquarkus.native.container-build=true\n\n# Build the docker image\ndocker build -f src/main/docker/Dockerfile.native -t catalog-ms-quarkus-native .\n\n# Run the application\ndocker run -it -d --rm -e quarkus.elasticsearch.hosts=http://host.docker.internal:9200 -e ibm.cn.application.client.InventoryServiceClient/mp-rest/url=http://host.docker.internal:8082/micro/inventory -p 8083:8080 catalog-ms-quarkus-native\n```\n\n- You can also verify it as follows.\n\n```\n$ docker ps\nCONTAINER ID   IMAGE                                                 COMMAND                  CREATED       STATUS       PORTS                                            NAMES\na5774b328b8d   catalog-ms-quarkus-native                             \"./application -Dqua…\"   2 days ago    Up 2 days    0.0.0.0:8083->8080/tcp                           inspiring_wozniak\n6c27955669e2   docker.elastic.co/elasticsearch/elasticsearch:6.3.2   \"/usr/local/bin/dock…\"   2 days ago    Up 2 days    0.0.0.0:9200->9200/tcp, 0.0.0.0:9300->9300/tcp   catalogelasticsearch\nb50a1ad23fed   inventory-ms-quarkus-native                           \"./application -Dqua…\"   2 days ago    Up 2 days    0.0.0.0:8082->8080/tcp                           pedantic_murdock\n20c0472e885f   mysql                                                 \"docker-entrypoint.s…\"   2 days ago    Up 2 days    0.0.0.0:3306->3306/tcp, 33060/tcp                inventorymysql\n```\n\n### Authentication using Keycloak\n\nKeycloak is used for storing users and authenticating users. To configure it, refer [Keycloak - JWT token generation](https://cloudnativereference.dev/related-repositories/keycloak/).\n\nMake sure you grab the `client_secret`. You need to pass it as a param in the below services.\n\n### Customer\n\n- Clone customer repository\n\n```bash\ngit clone https://github.com/ibm-garage-ref-storefront/customer-ms-quarkus.git\ncd customer-ms-quarkus\n```\n\n#### Deploy CouchDB\n\n<br></br>\n\n```\n# Start a CouchDB Container with a database user, and a password\ndocker run -d -e COUCHDB_USER='admin' -e COUCHDB_PASSWORD='password' -p 5984:5984 couchdb\n```\n\nIf it is successfully deployed, you will see something like below.\n\n```\n$ docker ps\nCONTAINER ID   IMAGE                                                 COMMAND                  CREATED       STATUS       PORTS                                            NAMES\n8b4430086226   couchdb                                               \"tini -- /docker-ent…\"   2 days ago    Up 2 days    4369/tcp, 9100/tcp, 0.0.0.0:5984->5984/tcp       angry_davinci\na5774b328b8d   catalog-ms-quarkus-native                             \"./application -Dqua…\"   2 days ago    Up 2 days    0.0.0.0:8083->8080/tcp                           inspiring_wozniak\n6c27955669e2   docker.elastic.co/elasticsearch/elasticsearch:6.3.2   \"/usr/local/bin/dock…\"   2 days ago    Up 2 days    0.0.0.0:9200->9200/tcp, 0.0.0.0:9300->9300/tcp   catalogelasticsearch\nb50a1ad23fed   inventory-ms-quarkus-native                           \"./application -Dqua…\"   2 days ago    Up 2 days    0.0.0.0:8082->8080/tcp                           pedantic_murdock\n20c0472e885f   mysql                                                 \"docker-entrypoint.s…\"   2 days ago    Up 2 days    0.0.0.0:3306->3306/tcp, 33060/tcp                inventorymysql\n1bdb13bf24cd   quay.io/keycloak/keycloak:12.0.2                      \"/opt/jboss/tools/do…\"   2 days ago    Up 2 days    8443/tcp, 0.0.0.0:8085->8080/tcp                 bold_elion\n```\n\n- Populate the database with user information.\n\n```\ncd populate\npython3 populate.py localhost 5984\ncd ..\n```\n\n#### Deploy Customer app\n\n<br></br>\n\nRun the below command.\n\n```\n# Package the application using native profile\n./mvnw package -Pnative -Dquarkus.native.container-build=true\n\n# Build the docker image\ndocker build -f src/main/docker/Dockerfile.native -t customer-ms-quarkus-native .\n\n# Run the application\ndocker run -it -d --rm -e ibm.cn.application.couchdb.client.CouchDBClientService/mp-rest/url=http://host.docker.internal:5984 -e couchuser=admin -e couchpassword=password -e quarkus.oidc.auth-server-url=http://host.docker.internal:8085/auth/realms/sfrealm -e quarkus.oidc.client-id=bluecomputeweb -e quarkus.oidc.credentials.secret=a297757d-d2cc-4921-8e66-971432a68826 -p 8087:8080 customer-ms-quarkus-native\n```\n\nNote: Set the `quarkus.oidc.credentials.secret` value to the value you grabbed earlier.\n\n- You can also verify it as follows.\n\n```\n$ docker ps\nCONTAINER ID   IMAGE                                                 COMMAND                  CREATED       STATUS       PORTS                                            NAMES\n4e0d5679fb92   customer-ms-quarkus-native                            \"./application -Dqua…\"   2 hours ago   Up 2 hours   0.0.0.0:8087->8080/tcp                           ecstatic_lumiere\n8b4430086226   couchdb                                               \"tini -- /docker-ent…\"   2 days ago    Up 2 days    4369/tcp, 9100/tcp, 0.0.0.0:5984->5984/tcp       angry_davinci\na5774b328b8d   catalog-ms-quarkus-native                             \"./application -Dqua…\"   2 days ago    Up 2 days    0.0.0.0:8083->8080/tcp                           inspiring_wozniak\n6c27955669e2   docker.elastic.co/elasticsearch/elasticsearch:6.3.2   \"/usr/local/bin/dock…\"   2 days ago    Up 2 days    0.0.0.0:9200->9200/tcp, 0.0.0.0:9300->9300/tcp   catalogelasticsearch\nb50a1ad23fed   inventory-ms-quarkus-native                           \"./application -Dqua…\"   2 days ago    Up 2 days    0.0.0.0:8082->8080/tcp                           pedantic_murdock\n20c0472e885f   mysql                                                 \"docker-entrypoint.s…\"   2 days ago    Up 2 days    0.0.0.0:3306->3306/tcp, 33060/tcp                inventorymysql\n1bdb13bf24cd   quay.io/keycloak/keycloak:12.0.2                      \"/opt/jboss/tools/do…\"   2 days ago    Up 2 days    8443/tcp, 0.0.0.0:8085->8080/tcp                 bold_elion\n```\n\n### Orders\n\n- Clone orders repository\n\n```bash\ngit clone https://github.com/ibm-garage-ref-storefront/orders-ms-quarkus.git\ncd orders-ms-quarkus\n```\n\n#### Deploy Mariadb\n\n<br></br>\n\n```\n# Start a MariaDB Container with a database user, a password, and create a new database\ndocker run --name ordersmysql \\\n    -e MYSQL_ROOT_PASSWORD=admin123 \\\n    -e MYSQL_USER=dbuser \\\n    -e MYSQL_PASSWORD=password \\\n    -e MYSQL_DATABASE=ordersdb \\\n    -p 3307:3306 \\\n    -d mariadb\n```\n\nIf it is successfully deployed, you will see something like below.\n\n```\n$ docker ps\nCONTAINER ID   IMAGE                                                 COMMAND                  CREATED       STATUS       PORTS                                            NAMES\n4e0d5679fb92   customer-ms-quarkus-native                            \"./application -Dqua…\"   2 hours ago   Up 2 hours   0.0.0.0:8087->8080/tcp                           ecstatic_lumiere\n8b4430086226   couchdb                                               \"tini -- /docker-ent…\"   2 days ago    Up 2 days    4369/tcp, 9100/tcp, 0.0.0.0:5984->5984/tcp       angry_davinci\n9d65ba050ad1   mariadb                                               \"docker-entrypoint.s…\"   2 days ago    Up 2 days    0.0.0.0:3307->3306/tcp                           ordersmysql\na5774b328b8d   catalog-ms-quarkus-native                             \"./application -Dqua…\"   2 days ago    Up 2 days    0.0.0.0:8083->8080/tcp                           inspiring_wozniak\n6c27955669e2   docker.elastic.co/elasticsearch/elasticsearch:6.3.2   \"/usr/local/bin/dock…\"   2 days ago    Up 2 days    0.0.0.0:9200->9200/tcp, 0.0.0.0:9300->9300/tcp   catalogelasticsearch\nb50a1ad23fed   inventory-ms-quarkus-native                           \"./application -Dqua…\"   2 days ago    Up 2 days    0.0.0.0:8082->8080/tcp                           pedantic_murdock\n20c0472e885f   mysql                                                 \"docker-entrypoint.s…\"   2 days ago    Up 2 days    0.0.0.0:3306->3306/tcp, 33060/tcp                inventorymysql\n1bdb13bf24cd   quay.io/keycloak/keycloak:12.0.2                      \"/opt/jboss/tools/do…\"   2 days ago    Up 2 days    8443/tcp, 0.0.0.0:8085->8080/tcp                 bold_elion\n```\n\n- Create the orders table.\n\nFirstly, `ssh` into the MariaDB container.\n\n```\ndocker exec -it ordersmysql bash\n```\n\n- Now, run the below command for table creation.\n\n```\nmysql -udbuser -ppassword\n```\n\n- This will take you to something like below.\n\n```\nroot@5762edb59a86:/# mysql -udbuser -ppassword\nWelcome to the MariaDB monitor.  Commands end with ; or \\g.\nYour MariaDB connection id is 22\nServer version: 10.5.5-MariaDB-1:10.5.5+maria~focal mariadb.org binary distribution\n\nCopyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nMariaDB [(none)]>\n```\n\n- Go to `scripts > mysql_data.sql`. Copy the contents from [mysql_data.sql](./scripts/mysql_data.sql) and paste the contents in the console.\n\n- You can exit from the console using `exit`.\n\n```\nMariaDB [(none)]> exit\nBye\n```\n\n- To come out of the container, enter `exit`.\n\n```\nroot@5762edb59a86:/# exit\n```\n\n#### Deploy Orders app\n\n<br></br>\n\nRun the below command.\n\n```\n# Package the application using native profile\n./mvnw package -Pnative -Dquarkus.native.container-build=true\n\n# Build the docker image\ndocker build -f src/main/docker/Dockerfile.native -t orders-ms-quarkus-native .\n\n# Run the application\ndocker run -it -d --rm -e quarkus.datasource.jdbc.url=jdbc:mysql://host.docker.internal:3307/ordersdb?useSSL=true -e quarkus.datasource.username=dbuser -e quarkus.datasource.password=password -e quarkus.oidc.auth-server-url=http://host.docker.internal:8085/auth/realms/sfrealm -e quarkus.oidc.client-id=bluecomputeweb -e quarkus.oidc.credentials.secret=a297757d-d2cc-4921-8e66-971432a68826 -p 8086:8080 orders-ms-quarkus-native\n```\n\nNote: Set the `quarkus.oidc.credentials.secret` value to the value you grabbed earlier.\n\n- You can also verify it as follows.\n\n```\n$ docker ps\nCONTAINER ID   IMAGE                                                 COMMAND                  CREATED       STATUS       PORTS                                            NAMES\n4e0d5679fb92   customer-ms-quarkus-native                            \"./application -Dqua…\"   2 hours ago   Up 2 hours   0.0.0.0:8087->8080/tcp                           ecstatic_lumiere\n8b4430086226   couchdb                                               \"tini -- /docker-ent…\"   2 days ago    Up 2 days    4369/tcp, 9100/tcp, 0.0.0.0:5984->5984/tcp       angry_davinci\nbc39c2469804   orders-ms-quarkus-native                              \"./application -Dqua…\"   2 days ago    Up 2 days    0.0.0.0:8086->8080/tcp                           dazzling_meitner\n9d65ba050ad1   mariadb                                               \"docker-entrypoint.s…\"   2 days ago    Up 2 days    0.0.0.0:3307->3306/tcp                           ordersmysql\na5774b328b8d   catalog-ms-quarkus-native                             \"./application -Dqua…\"   2 days ago    Up 2 days    0.0.0.0:8083->8080/tcp                           inspiring_wozniak\n6c27955669e2   docker.elastic.co/elasticsearch/elasticsearch:6.3.2   \"/usr/local/bin/dock…\"   2 days ago    Up 2 days    0.0.0.0:9200->9200/tcp, 0.0.0.0:9300->9300/tcp   catalogelasticsearch\nb50a1ad23fed   inventory-ms-quarkus-native                           \"./application -Dqua…\"   2 days ago    Up 2 days    0.0.0.0:8082->8080/tcp                           pedantic_murdock\n20c0472e885f   mysql                                                 \"docker-entrypoint.s…\"   2 days ago    Up 2 days    0.0.0.0:3306->3306/tcp, 33060/tcp                inventorymysql\n1bdb13bf24cd   quay.io/keycloak/keycloak:12.0.2                      \"/opt/jboss/tools/do…\"   2 days ago    Up 2 days    8443/tcp, 0.0.0.0:8085->8080/tcp                 bold_elion\n```\n\n### Storefront UI\n\n- Clone Storefront-UI repository\n\n```bash\ngit clone https://github.com/ibm-garage-ref-storefront/storefront-ui.git\ncd storefront-ui\ngit checkout hp-quarkus-version\n```\n\n#### Deploy Storefront UI\n\n<br></br>\n\n- Go to `config > default.json` and change the `client_secret` to the one you grabbed earlier from keycloak.\n\n- Run the below command.\n\n```\n# Build storefront ui docker image\nappsody build\n\n# Start the Storefront UI Container\ndocker run --name web \\\n  -e NODE_ENV=development \\\n  -p 3000:3000 \\\n  -d dev.local/web\n```\n\n- You can also verify it as follows.\n\n```\n$ docker ps\nCONTAINER ID   IMAGE                                                 COMMAND                  CREATED       STATUS       PORTS                                            NAMES\ne616793340c7   dev.local/web                                         \"container-entrypoin…\"   2 hours ago   Up 2 hours   0.0.0.0:3000->3000/tcp, 8080/tcp                 web\n4e0d5679fb92   customer-ms-quarkus-native                            \"./application -Dqua…\"   2 hours ago   Up 2 hours   0.0.0.0:8087->8080/tcp                           ecstatic_lumiere\n8b4430086226   couchdb                                               \"tini -- /docker-ent…\"   2 days ago    Up 2 days    4369/tcp, 9100/tcp, 0.0.0.0:5984->5984/tcp       angry_davinci\nbc39c2469804   orders-ms-quarkus-native                              \"./application -Dqua…\"   2 days ago    Up 2 days    0.0.0.0:8086->8080/tcp                           dazzling_meitner\n9d65ba050ad1   mariadb                                               \"docker-entrypoint.s…\"   2 days ago    Up 2 days    0.0.0.0:3307->3306/tcp                           ordersmysql\na5774b328b8d   catalog-ms-quarkus-native                             \"./application -Dqua…\"   2 days ago    Up 2 days    0.0.0.0:8083->8080/tcp                           inspiring_wozniak\n6c27955669e2   docker.elastic.co/elasticsearch/elasticsearch:6.3.2   \"/usr/local/bin/dock…\"   2 days ago    Up 2 days    0.0.0.0:9200->9200/tcp, 0.0.0.0:9300->9300/tcp   catalogelasticsearch\nb50a1ad23fed   inventory-ms-quarkus-native                           \"./application -Dqua…\"   2 days ago    Up 2 days    0.0.0.0:8082->8080/tcp                           pedantic_murdock\n20c0472e885f   mysql                                                 \"docker-entrypoint.s…\"   2 days ago    Up 2 days    0.0.0.0:3306->3306/tcp, 33060/tcp                inventorymysql\n1bdb13bf24cd   quay.io/keycloak/keycloak:12.0.2                      \"/opt/jboss/tools/do…\"   2 days ago    Up 2 days    8443/tcp, 0.0.0.0:8085->8080/tcp                 bold_elion\n```\n\nThere you go, you deploy all the necessary services for storefront.\n\nNow, let us check the app out. You can access it at http://localhost:3000.\n\n![Storefront](../../images/web.png)\n","fileAbsolutePath":"/home/travis/build/ibm-garage-ref-storefront/docs/src/pages/deployments/quarkus.mdx"}}}}