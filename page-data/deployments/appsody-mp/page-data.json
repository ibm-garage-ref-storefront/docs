{"componentChunkName":"component---src-pages-deployments-appsody-mp-mdx","path":"/deployments/appsody-mp/","result":{"pageContext":{"frontmatter":{"title":"Deploy Storefront (Openliberty Version) locally on your machine","description":"Instructions to deploy storefront locally"},"relativePagePath":"/deployments/appsody-mp.mdx","titleType":"page","MdxNode":{"id":"8462c613-f23a-507e-a5b2-5b2d580513b8","children":[],"parent":"b566e5f0-227e-59db-87e4-6563bf23a87c","internal":{"content":"---\ntitle: Deploy Storefront (Openliberty Version) locally on your machine\ndescription: Instructions to deploy storefront locally\n---\n\n## Introduction\n\nStorefront is a simple shopping application that displays a catalog of antique computing devices, where users can search and buy products. It has a Web interface, and it relies on BFF (Backend for Frontend) services to interact with the backend services.\n\n## Pre-requisites:\n\n* [Appsody](https://appsody.dev/)\n  - [Installing on MacOS](https://appsody.dev/docs/installing/macos)\n  - [Installing on Windows](https://appsody.dev/docs/installing/windows)\n  - [Installing on RHEL](https://appsody.dev/docs/installing/rhel)\n  - [Installing on Ubuntu](https://appsody.dev/docs/installing/ubuntu)\n\nFor more details on installation, check [this](https://appsody.dev/docs/installing/installing-appsody/) out.\n\n* Docker Desktop\n  - [Docker for Mac](https://docs.docker.com/docker-for-mac/)\n  - [Docker for Windows](https://docs.docker.com/docker-for-windows/)\n\n* [IBM Mobile Foundation CLI](https://www.npmjs.com/package/mfpdev-cli)\n* [Ionic CLI Version 5.4.16](https://ionicframework.com/docs/cli)\n\n## Running the application locally\n\nLet us now deploy all the microservices of our storefront one by one locally.\n\n#### Deploy JAEGER\n\n- Deploy Jaeger as follows\n\n```\ndocker run -d --name jaeger   -e COLLECTOR_ZIPKIN_HTTP_PORT=9411   -p 5775:5775/udp   -p 6831:6831/udp   -p 6832:6832/udp   -p 5778:5778   -p 16686:16686   -p 14268:14268   -p 9411:9411   jaegertracing/all-in-one:1.11\n```\n\nIf it is successfully deployed, you will see something like below.\n\n```\n$ docker ps\nCONTAINER ID        IMAGE                           COMMAND                  CREATED             STATUS              PORTS                                                                                                                                                                     NAMES\ndf370368c115        jaegertracing/all-in-one:1.11   \"/go/bin/all-in-one-…\"   3 minutes ago       Up 3 minutes        0.0.0.0:5775->5775/udp, 0.0.0.0:5778->5778/tcp, 0.0.0.0:9411->9411/tcp, 0.0.0.0:14268->14268/tcp, 0.0.0.0:6831-6832->6831-6832/udp, 0.0.0.0:16686->16686/tcp, 14250/tcp   jaeger\n```\n\n### Inventory\n\n- Clone inventory repository\n\n```bash\ngit clone https://github.com/ibm-garage-ref-storefront/inventory-ms-openliberty\ncd inventory-ms-openliberty\n```\n\n#### Deploy MySQL database\n\n<br></br>\n\n```\n# Start a MySQL Container with a database user, a password, and create a new database\ndocker run --name inventorymysql \\\n    -e MYSQL_ROOT_PASSWORD=admin123 \\\n    -e MYSQL_USER=dbuser \\\n    -e MYSQL_PASSWORD=password \\\n    -e MYSQL_DATABASE=inventorydb \\\n    -p 3306:3306 \\\n    -d mysql:5.7.14\n```\n\nIf it is successfully deployed, you will see something like below.\n\n```\n$ docker ps\nCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                    NAMES\n6156756ba27c        mysql:5.7.14        \"docker-entrypoint.s…\"   5 seconds ago       Up 3 seconds        0.0.0.0:3306->3306/tcp   inventorymysql\n```\n\n- Now let us populate the MySQL with data.\n\nFirstly, `ssh` into the MySQL container.\n\n```\ndocker exec -it inventorymysql bash\n```\n\n- Now, run the below command for table creation.\n\n```\nmysql -udbuser -ppassword\n```\n\n- This will take you to something like below.\n\n```\nroot@d88a6e5973de:/# mysql -udbuser -ppassword\nmysql: [Warning] Using a password on the command line interface can be insecure.\nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 2\nServer version: 5.7.14 MySQL Community Server (GPL)\n\nCopyright (c) 2000, 2016, Oracle and/or its affiliates. All rights reserved.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nmysql>\n```\n\n- Go to `scripts > mysql_data.sql`. Copy the contents from [mysql_data.sql](https://github.com/ibm-garage-ref-storefront/inventory-ms-spring/blob/master/scripts/mysql_data.sql) and paste the contents in the console.\n\n- You can exit from the console using `exit`.\n\n```\nmysql> exit\nBye\n```\n\n- To come out of the container, enter `exit`.\n\n```\nroot@d88a6e5973de:/# exit\n```\n\n#### Deploy Inventory app\n\n<br></br>\n\nRun the below command.\n\n```\n# Build inventory docker image\nappsody build\n\n# Start the Inventory Container\ndocker run --name inventory-ms-openliberty \\\n     -e jdbcURL=jdbc:mysql://host.docker.internal:3306/inventorydb?useSSL=true \\\n     -e dbuser=dbuser \\\n     -e dbpassword=password \\\n     -e JAEGER_SERVICE_NAME=inventory-ms-openliberty \\\n     -e JAEGER_AGENT_HOST=host.docker.internal \\\n     -e JAEGER_AGENT_PORT=6831 \\\n     -e JAEGER_REPORTER_LOG_SPANS=true \\\n     -e JAEGER_REPORTER_FLUSH_INTERVAL=2000 \\\n     -e JAEGER_SAMPLER_TYPE=const \\\n     -e JAEGER_SAMPLER_PARAM=1 \\\n     -p 9081:9080 \\\n     -d dev.local/inventory-ms-openliberty\n```\n\n- You can also verify it as follows.\n\n```\n$ docker ps\nCONTAINER ID        IMAGE                                COMMAND                  CREATED             STATUS              PORTS                                                                                                                                                                     NAMES\nc83fb01c87f9        dev.local/inventory-ms-openliberty   \"/opt/ol/helpers/run…\"   About an hour ago   Up About an hour    9443/tcp, 0.0.0.0:9081->9080/tcp                                                                                                                                          inventory-ms-openliberty\ndf370368c115        jaegertracing/all-in-one:1.11        \"/go/bin/all-in-one-…\"   About an hour ago   Up About an hour    0.0.0.0:5775->5775/udp, 0.0.0.0:5778->5778/tcp, 0.0.0.0:9411->9411/tcp, 0.0.0.0:14268->14268/tcp, 0.0.0.0:6831-6832->6831-6832/udp, 0.0.0.0:16686->16686/tcp, 14250/tcp   jaeger\n6156756ba27c        mysql:5.7.14                         \"docker-entrypoint.s…\"   About an hour ago   Up About an hour    0.0.0.0:3306->3306/tcp                                                                                                                                                    inventorymysql\n```\n\n- Exit out of repo.\n\n```\ncd ..\n```\n\n### Catalog\n\n- Clone catalog repository\n\n```bash\ngit clone https://github.com/ibm-garage-ref-storefront/catalog-ms-spring.git\ncd catalog-ms-spring\n```\n\n#### Deploy ElasticSearch\n\n<br></br>\n\n```\n# Start an Elasticsearch Container\ndocker run --name catalogelasticsearch \\\n  -e \"discovery.type=single-node\" \\\n  -p 9200:9200 \\\n  -p 9300:9300 \\\n  -d docker.elastic.co/elasticsearch/elasticsearch:6.3.2\n```\n\nIf it is successfully deployed, you will see something like below.\n\n```\n$ docker ps\nCONTAINER ID        IMAGE                                                 COMMAND                  CREATED             STATUS              PORTS                                                                                                                                                                     NAMES\n07fb73eba00b        docker.elastic.co/elasticsearch/elasticsearch:6.3.2   \"/usr/local/bin/dock…\"   25 seconds ago      Up 20 seconds       0.0.0.0:9200->9200/tcp, 0.0.0.0:9300->9300/tcp                                                                                                                            catalogelasticsearch\nc83fb01c87f9        dev.local/inventory-ms-openliberty                    \"/opt/ol/helpers/run…\"   About an hour ago   Up About an hour    9443/tcp, 0.0.0.0:9081->9080/tcp                                                                                                                                          inventory-ms-openliberty\ndf370368c115        jaegertracing/all-in-one:1.11                         \"/go/bin/all-in-one-…\"   About an hour ago   Up About an hour    0.0.0.0:5775->5775/udp, 0.0.0.0:5778->5778/tcp, 0.0.0.0:9411->9411/tcp, 0.0.0.0:14268->14268/tcp, 0.0.0.0:6831-6832->6831-6832/udp, 0.0.0.0:16686->16686/tcp, 14250/tcp   jaeger\n6156756ba27c        mysql:5.7.14                                          \"docker-entrypoint.s…\"   About an hour ago   Up About an hour    0.0.0.0:3306->3306/tcp                                                                                                                                                    inventorymysql\n```\n\n#### Deploy Catalog app\n\n<br></br>\n\nRun the below command.\n\n```\n# Build catalog docker image\nappsody build\n\n# Start the Catalog Container\ndocker run --name catalog-ms-openliberty \\\n  -e elasticsearch_url=http://host.docker.internal:9200 \\\n  -e elasticsearch_index=micro \\\n  -e elasticsearch_doc_type=items \\\n  -e dev.appsody.application.client.InventoryServiceClient/mp-rest/url=http://host.docker.internal:9081/micro/inventory \\\n  -e inventory_health=http://host.docker.internal:9081/health \\\n  -e JAEGER_SERVICE_NAME=catalog-ms-openliberty \\\n  -e JAEGER_AGENT_HOST=host.docker.internal \\\n  -e JAEGER_AGENT_PORT=6831 \\\n  -e JAEGER_REPORTER_LOG_SPANS=true \\\n  -e JAEGER_REPORTER_FLUSH_INTERVAL=2000 \\\n  -e JAEGER_SAMPLER_TYPE=const \\\n  -e JAEGER_SAMPLER_PARAM=1 \\\n  -p 9082:9080 \\\n  -d dev.local/catalog-ms-openliberty\n```\n\n- You can also verify it as follows.\n\n```\n$ docker ps\nCONTAINER ID        IMAGE                                                 COMMAND                  CREATED             STATUS              PORTS                                                                                                                                                                     NAMES\n3d000493ff61        dev.local/catalog-ms-openliberty                      \"/opt/ol/helpers/run…\"   9 seconds ago       Up 8 seconds        9443/tcp, 0.0.0.0:9082->9080/tcp                                                                                                                                          catalog-ms-openliberty\n07fb73eba00b        docker.elastic.co/elasticsearch/elasticsearch:6.3.2   \"/usr/local/bin/dock…\"   31 minutes ago      Up 31 minutes       0.0.0.0:9200->9200/tcp, 0.0.0.0:9300->9300/tcp                                                                                                                            catalogelasticsearch\nc83fb01c87f9        dev.local/inventory-ms-openliberty                    \"/opt/ol/helpers/run…\"   2 hours ago         Up 2 hours          9443/tcp, 0.0.0.0:9081->9080/tcp                                                                                                                                          inventory-ms-openliberty\ndf370368c115        jaegertracing/all-in-one:1.11                         \"/go/bin/all-in-one-…\"   2 hours ago         Up 2 hours          0.0.0.0:5775->5775/udp, 0.0.0.0:5778->5778/tcp, 0.0.0.0:9411->9411/tcp, 0.0.0.0:14268->14268/tcp, 0.0.0.0:6831-6832->6831-6832/udp, 0.0.0.0:16686->16686/tcp, 14250/tcp   jaeger\n6156756ba27c        mysql:5.7.14                                          \"docker-entrypoint.s…\"   2 hours ago         Up 2 hours          0.0.0.0:3306->3306/tcp                                                                                                                                                    inventorymysql\n```\n\n- Exit out of repo.\n\n```\ncd ..\n```\n\n### Set Up Keystore\n\n- Clone the below repositories\n\n```bash\ngit clone https://github.com/ibm-garage-ref-storefront/auth-ms-openliberty.git\ngit clone https://github.com/ibm-garage-ref-storefront/customer-ms-openliberty.git\ngit clone https://github.com/ibm-garage-ref-storefront/orders-ms-openliberty.git\n```\n- Clone storefront automator\n\n```bash\ngit clone https://github.com/ibm-garage-ref-storefront/storefront-repo-automator.git\ncd storefront-repo-automator\n```\n\n- Run the below script to create necessary key store files in auth-ms-openliberty, customer-ms-openliberty, and orders-ms-openliberty\n\n```bash\n./keystore.sh\n```\n\nIf successfully created, you will see something like below.\n\n```\n$ ./keystore.sh\nKeystore type: PKCS12\nKeystore provider: SUN\n\nYour keystore contains 1 entry\n\nbckey, Nov 26, 2020, PrivateKeyEntry,\nCertificate fingerprint (SHA1): C8:60:C0:4B:8D:46:70:10:AE:6E:82:9B:61:67:C0:BD:68:42:D9:0F\nCertificate stored in file <client.cer>\nCertificate was added to keystore\n[Storing ./truststore.p12]\n```\n\n- Exit out of repo.\n\n```\ncd ..\n```\n\n### Auth\n\n- Go to auth repository\n\n```bash\ncd auth-ms-openliberty\n```\n\n#### Deploy Auth app\n\n<br></br>\n\nRun the below command.\n\n```\n# Build auth docker image\nappsody build\n\n# Start the Auth Container\ndocker run --name auth-ms-openliberty \\\n  -p 9083:9080 \\\n  -p 9444:9443 \\\n  -e jwksIssuer=\"https://localhost:9444/oidc/endpoint/OP\" \\\n  -d dev.local/auth-ms-openliberty\n```\n\n- You can also verify it as follows.\n\n```\n$ docker ps\nCONTAINER ID        IMAGE                                                 COMMAND                  CREATED             STATUS              PORTS                                                                                                                                                                     NAMES\nf27f340d270f        dev.local/auth-ms-openliberty                         \"/opt/ol/helpers/run…\"   8 seconds ago       Up 7 seconds        0.0.0.0:9083->9080/tcp, 0.0.0.0:9444->9443/tcp                                                                                                                            auth-ms-openliberty\n3d000493ff61        dev.local/catalog-ms-openliberty                      \"/opt/ol/helpers/run…\"   12 minutes ago      Up 12 minutes       9443/tcp, 0.0.0.0:9082->9080/tcp                                                                                                                                          catalog-ms-openliberty\n07fb73eba00b        docker.elastic.co/elasticsearch/elasticsearch:6.3.2   \"/usr/local/bin/dock…\"   43 minutes ago      Up 43 minutes       0.0.0.0:9200->9200/tcp, 0.0.0.0:9300->9300/tcp                                                                                                                            catalogelasticsearch\nc83fb01c87f9        dev.local/inventory-ms-openliberty                    \"/opt/ol/helpers/run…\"   2 hours ago         Up 2 hours          9443/tcp, 0.0.0.0:9081->9080/tcp                                                                                                                                          inventory-ms-openliberty\ndf370368c115        jaegertracing/all-in-one:1.11                         \"/go/bin/all-in-one-…\"   2 hours ago         Up 2 hours          0.0.0.0:5775->5775/udp, 0.0.0.0:5778->5778/tcp, 0.0.0.0:9411->9411/tcp, 0.0.0.0:14268->14268/tcp, 0.0.0.0:6831-6832->6831-6832/udp, 0.0.0.0:16686->16686/tcp, 14250/tcp   jaeger\n6156756ba27c        mysql:5.7.14                                          \"docker-entrypoint.s…\"   2 hours ago         Up 2 hours          0.0.0.0:3306->3306/tcp                                                                                                                                                    inventorymysql\n```\n\n- Exit out of repo.\n\n```\ncd ..\n```\n\n### Customer\n\n- Go to customer repository\n\n```bash\ncd customer-ms-openliberty\n```\n\n#### Deploy CouchDB\n\n<br></br>\n\n```\n# Start a CouchDB Container with a database user, a password, and create a new database\ndocker run -d -e COUCHDB_USER='admin' -e COUCHDB_PASSWORD='password' -p 5984:5984 couchdb\n```\n\nIf it is successfully deployed, you will see something like below.\n\n```\n$ docker ps\nCONTAINER ID        IMAGE                                                 COMMAND                  CREATED             STATUS              PORTS                                                                                                                                                                     NAMES\nd0f2e4491ec9        couchdb                                               \"tini -- /docker-ent…\"   7 seconds ago       Up 6 seconds        4369/tcp, 9100/tcp, 0.0.0.0:5984->5984/tcp                                                                                                                                beautiful_goldberg\nf27f340d270f        dev.local/auth-ms-openliberty                         \"/opt/ol/helpers/run…\"   2 minutes ago       Up 2 minutes        0.0.0.0:9083->9080/tcp, 0.0.0.0:9444->9443/tcp                                                                                                                            auth-ms-openliberty\n3d000493ff61        dev.local/catalog-ms-openliberty                      \"/opt/ol/helpers/run…\"   14 minutes ago      Up 14 minutes       9443/tcp, 0.0.0.0:9082->9080/tcp                                                                                                                                          catalog-ms-openliberty\n07fb73eba00b        docker.elastic.co/elasticsearch/elasticsearch:6.3.2   \"/usr/local/bin/dock…\"   45 minutes ago      Up 45 minutes       0.0.0.0:9200->9200/tcp, 0.0.0.0:9300->9300/tcp                                                                                                                            catalogelasticsearch\nc83fb01c87f9        dev.local/inventory-ms-openliberty                    \"/opt/ol/helpers/run…\"   2 hours ago         Up 2 hours          9443/tcp, 0.0.0.0:9081->9080/tcp                                                                                                                                          inventory-ms-openliberty\ndf370368c115        jaegertracing/all-in-one:1.11                         \"/go/bin/all-in-one-…\"   2 hours ago         Up 2 hours          0.0.0.0:5775->5775/udp, 0.0.0.0:5778->5778/tcp, 0.0.0.0:9411->9411/tcp, 0.0.0.0:14268->14268/tcp, 0.0.0.0:6831-6832->6831-6832/udp, 0.0.0.0:16686->16686/tcp, 14250/tcp   jaeger\n6156756ba27c        mysql:5.7.14                                          \"docker-entrypoint.s…\"   2 hours ago         Up 2 hours          0.0.0.0:3306->3306/tcp                                                                                                                                                    inventorymysql\n```\n\n- Populate the database with user information.\n\n```\ncd populate\npython3 populate.py localhost 5984\ncd ..\n```\n\n#### Deploy Customer app\n\n<br></br>\n\nRun the below command.\n\n```\n# Build customer docker image\nappsody build\n\n# Start the customer Container\ndocker run --name customer-ms-openliberty \\\n  -e jwksIssuer=\"https://localhost:9444/oidc/endpoint/OP\" \\\n  -e keystorePassword=\"password\" \\\n  -e dev.appsody.customer.client.CouchDBClientService/mp-rest/url=\"http://host.docker.internal:5984\" \\\n  -e couchuser=admin \\\n  -e couchpassword=password \\\n  -e JAEGER_SERVICE_NAME=customer-ms-openliberty \\\n  -e JAEGER_AGENT_HOST=host.docker.internal \\\n  -e JAEGER_AGENT_PORT=6831 \\\n  -e JAEGER_REPORTER_LOG_SPANS=true \\\n  -e JAEGER_REPORTER_FLUSH_INTERVAL=2000 \\\n  -e JAEGER_SAMPLER_TYPE=const \\\n  -e JAEGER_SAMPLER_PARAM=1 \\\n  -p 9085:9080 \\\n  -p 9446:9443 \\\n  -d dev.local/customer-ms-openliberty\n```\n\n- You can also verify it as follows.\n\n```\n$ docker ps\nCONTAINER ID        IMAGE                                                 COMMAND                  CREATED             STATUS              PORTS                                                                                                                                                                     NAMES\n3a6cd3a178ee        dev.local/customer-ms-openliberty                     \"/opt/ol/helpers/run…\"   5 seconds ago       Up 3 seconds        0.0.0.0:9085->9080/tcp, 0.0.0.0:9446->9443/tcp                                                                                                                            customer-ms-openliberty\nd0f2e4491ec9        couchdb                                               \"tini -- /docker-ent…\"   3 minutes ago       Up 3 minutes        4369/tcp, 9100/tcp, 0.0.0.0:5984->5984/tcp                                                                                                                                beautiful_goldberg\nf27f340d270f        dev.local/auth-ms-openliberty                         \"/opt/ol/helpers/run…\"   5 minutes ago       Up 5 minutes        0.0.0.0:9083->9080/tcp, 0.0.0.0:9444->9443/tcp                                                                                                                            auth-ms-openliberty\n3d000493ff61        dev.local/catalog-ms-openliberty                      \"/opt/ol/helpers/run…\"   17 minutes ago      Up 17 minutes       9443/tcp, 0.0.0.0:9082->9080/tcp                                                                                                                                          catalog-ms-openliberty\n07fb73eba00b        docker.elastic.co/elasticsearch/elasticsearch:6.3.2   \"/usr/local/bin/dock…\"   48 minutes ago      Up 48 minutes       0.0.0.0:9200->9200/tcp, 0.0.0.0:9300->9300/tcp                                                                                                                            catalogelasticsearch\nc83fb01c87f9        dev.local/inventory-ms-openliberty                    \"/opt/ol/helpers/run…\"   2 hours ago         Up 2 hours          9443/tcp, 0.0.0.0:9081->9080/tcp                                                                                                                                          inventory-ms-openliberty\ndf370368c115        jaegertracing/all-in-one:1.11                         \"/go/bin/all-in-one-…\"   2 hours ago         Up 2 hours          0.0.0.0:5775->5775/udp, 0.0.0.0:5778->5778/tcp, 0.0.0.0:9411->9411/tcp, 0.0.0.0:14268->14268/tcp, 0.0.0.0:6831-6832->6831-6832/udp, 0.0.0.0:16686->16686/tcp, 14250/tcp   jaeger\n6156756ba27c        mysql:5.7.14                                          \"docker-entrypoint.s…\"   2 hours ago         Up 2 hours          0.0.0.0:3306->3306/tcp                                                                                                                                                    inventorymysql\n```\n\n- Exit out of repo.\n\n```\ncd ..\n```\n\n### Orders\n\n- Go to orders repository\n\n```bash\ncd orders-ms-openliberty\n```\n\n#### Deploy Mariadb\n\n<br></br>\n\n```\n# Start a MariaDB Container with a database user, a password, and create a new database\ndocker run --name ordersmysql \\\n    -e MYSQL_ROOT_PASSWORD=admin123 \\\n    -e MYSQL_USER=dbuser \\\n    -e MYSQL_PASSWORD=password \\\n    -e MYSQL_DATABASE=ordersdb \\\n    -p 3307:3306 \\\n    -d mariadb\n```\n\nIf it is successfully deployed, you will see something like below.\n\n```\n$ docker ps\nCONTAINER ID        IMAGE                                                 COMMAND                  CREATED             STATUS              PORTS                                                                                                                                                                     NAMES\n12bfad474f24        mariadb                                               \"docker-entrypoint.s…\"   48 seconds ago      Up 45 seconds       0.0.0.0:3307->3306/tcp                                                                                                                                                    ordersmysql\n3a6cd3a178ee        dev.local/customer-ms-openliberty                     \"/opt/ol/helpers/run…\"   3 minutes ago       Up 3 minutes        0.0.0.0:9085->9080/tcp, 0.0.0.0:9446->9443/tcp                                                                                                                            customer-ms-openliberty\nd0f2e4491ec9        couchdb                                               \"tini -- /docker-ent…\"   6 minutes ago       Up 6 minutes        4369/tcp, 9100/tcp, 0.0.0.0:5984->5984/tcp                                                                                                                                beautiful_goldberg\nf27f340d270f        dev.local/auth-ms-openliberty                         \"/opt/ol/helpers/run…\"   8 minutes ago       Up 8 minutes        0.0.0.0:9083->9080/tcp, 0.0.0.0:9444->9443/tcp                                                                                                                            auth-ms-openliberty\n3d000493ff61        dev.local/catalog-ms-openliberty                      \"/opt/ol/helpers/run…\"   21 minutes ago      Up 20 minutes       9443/tcp, 0.0.0.0:9082->9080/tcp                                                                                                                                          catalog-ms-openliberty\n07fb73eba00b        docker.elastic.co/elasticsearch/elasticsearch:6.3.2   \"/usr/local/bin/dock…\"   51 minutes ago      Up 51 minutes       0.0.0.0:9200->9200/tcp, 0.0.0.0:9300->9300/tcp                                                                                                                            catalogelasticsearch\nc83fb01c87f9        dev.local/inventory-ms-openliberty                    \"/opt/ol/helpers/run…\"   2 hours ago         Up 2 hours          9443/tcp, 0.0.0.0:9081->9080/tcp                                                                                                                                          inventory-ms-openliberty\ndf370368c115        jaegertracing/all-in-one:1.11                         \"/go/bin/all-in-one-…\"   2 hours ago         Up 2 hours          0.0.0.0:5775->5775/udp, 0.0.0.0:5778->5778/tcp, 0.0.0.0:9411->9411/tcp, 0.0.0.0:14268->14268/tcp, 0.0.0.0:6831-6832->6831-6832/udp, 0.0.0.0:16686->16686/tcp, 14250/tcp   jaeger\n6156756ba27c        mysql:5.7.14                                          \"docker-entrypoint.s…\"   2 hours ago         Up 2 hours          0.0.0.0:3306->3306/tcp                                                                                                                                                    inventorymysql\n```\n\n- Create the orders table.\n\nFirstly ssh into the MySQL container.\n\n```bash\ndocker exec -it ordersmysql bash\n```\n\n- Now, run the below command for table creation.\n\n```\nmysql -udbuser -ppassword\n```\n\n- This will take you to something like below.\n\n```bash\nroot@5762edb59a86:/# mysql -udbuser -ppassword\nWelcome to the MariaDB monitor.  Commands end with ; or \\g.\nYour MariaDB connection id is 22\nServer version: 10.5.5-MariaDB-1:10.5.5+maria~focal mariadb.org binary distribution\n\nCopyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nMariaDB [(none)]>\n```\n\n- Go to scripts > [mysql_data.sql](https://github.com/ibm-garage-ref-storefront/orders-ms-openliberty/blob/master/scripts/mysql_data.sql). Copy the contents from mysql_data.sql and paste the contents in the console.\n\n- You can exit from the console using `exit`.\n\n```bash\nMariaDB [(none)]> exit\nBye\n```\n\n- To come out of the container, enter exit.\n\n```bash\nroot@5762edb59a86:/# exit\nexit\n```\n\n#### Deploy Orders app\n\n<br></br>\n\nRun the below command.\n\n```\n# Build orders docker image\nappsody build\n\n# Start the Orders Container\ndocker run --name orders-ms-openliberty \\\n  -e jdbcURL=jdbc:mysql://host.docker.internal:3307/ordersdb?useSSL=true \\\n  -e dbuser=dbuser \\\n  -e dbpassword=password \\\n  -e jwksIssuer=\"https://localhost:9444/oidc/endpoint/OP\" \\\n  -e JAEGER_SERVICE_NAME=orders-ms-openliberty \\\n  -e JAEGER_AGENT_HOST=host.docker.internal \\\n  -e JAEGER_AGENT_PORT=6831 \\\n  -e JAEGER_REPORTER_LOG_SPANS=true \\\n  -e JAEGER_REPORTER_FLUSH_INTERVAL=2000 \\\n  -e JAEGER_SAMPLER_TYPE=const \\\n  -e JAEGER_SAMPLER_PARAM=1 \\\n  -p 9084:9080 \\\n  -p 9445:9443 \\\n  -d dev.local/orders-ms-openliberty\n```\n\n- You can also verify it as follows.\n\n```\n$ docker ps\nCONTAINER ID        IMAGE                                                 COMMAND                  CREATED             STATUS              PORTS                                                                                                                                                                     NAMES\nc6ca0064e496        dev.local/orders-ms-openliberty                       \"/opt/ol/helpers/run…\"   8 seconds ago       Up 6 seconds        0.0.0.0:9084->9080/tcp, 0.0.0.0:9445->9443/tcp                                                                                                                            orders-ms-openliberty\n12bfad474f24        mariadb                                               \"docker-entrypoint.s…\"   5 hours ago         Up 5 hours          0.0.0.0:3307->3306/tcp                                                                                                                                                    ordersmysql\n3a6cd3a178ee        dev.local/customer-ms-openliberty                     \"/opt/ol/helpers/run…\"   5 hours ago         Up 5 hours          0.0.0.0:9085->9080/tcp, 0.0.0.0:9446->9443/tcp                                                                                                                            customer-ms-openliberty\nd0f2e4491ec9        couchdb                                               \"tini -- /docker-ent…\"   5 hours ago         Up 5 hours          4369/tcp, 9100/tcp, 0.0.0.0:5984->5984/tcp                                                                                                                                beautiful_goldberg\nf27f340d270f        dev.local/auth-ms-openliberty                         \"/opt/ol/helpers/run…\"   5 hours ago         Up 5 hours          0.0.0.0:9083->9080/tcp, 0.0.0.0:9444->9443/tcp                                                                                                                            auth-ms-openliberty\n3d000493ff61        dev.local/catalog-ms-openliberty                      \"/opt/ol/helpers/run…\"   5 hours ago         Up 5 hours          9443/tcp, 0.0.0.0:9082->9080/tcp                                                                                                                                          catalog-ms-openliberty\n07fb73eba00b        docker.elastic.co/elasticsearch/elasticsearch:6.3.2   \"/usr/local/bin/dock…\"   5 hours ago         Up 5 hours          0.0.0.0:9200->9200/tcp, 0.0.0.0:9300->9300/tcp                                                                                                                            catalogelasticsearch\nc83fb01c87f9        dev.local/inventory-ms-openliberty                    \"/opt/ol/helpers/run…\"   7 hours ago         Up 7 hours          9443/tcp, 0.0.0.0:9081->9080/tcp                                                                                                                                          inventory-ms-openliberty\ndf370368c115        jaegertracing/all-in-one:1.11                         \"/go/bin/all-in-one-…\"   7 hours ago         Up 7 hours          0.0.0.0:5775->5775/udp, 0.0.0.0:5778->5778/tcp, 0.0.0.0:9411->9411/tcp, 0.0.0.0:14268->14268/tcp, 0.0.0.0:6831-6832->6831-6832/udp, 0.0.0.0:16686->16686/tcp, 14250/tcp   jaeger\n6156756ba27c        mysql:5.7.14                                          \"docker-entrypoint.s…\"   7 hours ago         Up 7 hours          0.0.0.0:3306->3306/tcp                                                                                                                                                    inventorymysql\n```\n\n- Exit out of repo.\n\n```\ncd ..\n```\n\n### Storefront UI\n\n- Clone Storefront-UI repository\n\n```bash\ngit clone https://github.com/ibm-garage-ref-storefront/storefront-ui.git\ncd storefront-ui\n```\n\n#### Deploy Storefront UI\n\n<br></br>\n\nRun the below command.\n\n```\n# Build storefront ui docker image\nappsody build\n\n# Start the Storefront UI Container\ndocker run --name web \\\n  -e NODE_ENV=development \\\n  -p 3000:3000 \\\n  -d dev.local/web\n```\n\n- You can also verify it as follows.\n\n```\n$ docker ps\nCONTAINER ID        IMAGE                                                 COMMAND                  CREATED             STATUS              PORTS                                                                                                                                                                     NAMES\n60d37579ce50        dev.local/web                                         \"container-entrypoin…\"   11 seconds ago      Up 9 seconds        0.0.0.0:3000->3000/tcp, 8080/tcp                                                                                                                                          web\nc6ca0064e496        dev.local/orders-ms-openliberty                       \"/opt/ol/helpers/run…\"   14 minutes ago      Up 14 minutes       0.0.0.0:9084->9080/tcp, 0.0.0.0:9445->9443/tcp                                                                                                                            orders-ms-openliberty\n12bfad474f24        mariadb                                               \"docker-entrypoint.s…\"   5 hours ago         Up 5 hours          0.0.0.0:3307->3306/tcp                                                                                                                                                    ordersmysql\n3a6cd3a178ee        dev.local/customer-ms-openliberty                     \"/opt/ol/helpers/run…\"   5 hours ago         Up 5 hours          0.0.0.0:9085->9080/tcp, 0.0.0.0:9446->9443/tcp                                                                                                                            customer-ms-openliberty\nd0f2e4491ec9        couchdb                                               \"tini -- /docker-ent…\"   5 hours ago         Up 5 hours          4369/tcp, 9100/tcp, 0.0.0.0:5984->5984/tcp                                                                                                                                beautiful_goldberg\nf27f340d270f        dev.local/auth-ms-openliberty                         \"/opt/ol/helpers/run…\"   5 hours ago         Up 5 hours          0.0.0.0:9083->9080/tcp, 0.0.0.0:9444->9443/tcp                                                                                                                            auth-ms-openliberty\n3d000493ff61        dev.local/catalog-ms-openliberty                      \"/opt/ol/helpers/run…\"   5 hours ago         Up 5 hours          9443/tcp, 0.0.0.0:9082->9080/tcp                                                                                                                                          catalog-ms-openliberty\n07fb73eba00b        docker.elastic.co/elasticsearch/elasticsearch:6.3.2   \"/usr/local/bin/dock…\"   6 hours ago         Up 6 hours          0.0.0.0:9200->9200/tcp, 0.0.0.0:9300->9300/tcp                                                                                                                            catalogelasticsearch\nc83fb01c87f9        dev.local/inventory-ms-openliberty                    \"/opt/ol/helpers/run…\"   7 hours ago         Up 7 hours          9443/tcp, 0.0.0.0:9081->9080/tcp                                                                                                                                          inventory-ms-openliberty\ndf370368c115        jaegertracing/all-in-one:1.11                         \"/go/bin/all-in-one-…\"   7 hours ago         Up 7 hours          0.0.0.0:5775->5775/udp, 0.0.0.0:5778->5778/tcp, 0.0.0.0:9411->9411/tcp, 0.0.0.0:14268->14268/tcp, 0.0.0.0:6831-6832->6831-6832/udp, 0.0.0.0:16686->16686/tcp, 14250/tcp   jaeger\n6156756ba27c        mysql:5.7.14                                          \"docker-entrypoint.s…\"   7 hours ago         Up 7 hours          0.0.0.0:3306->3306/tcp                                                                                                                                                    inventorymysql\n```\n\nThere you go, you deploy all the necessary services for storefront.\n\nNow, let us check the app out. You can access it at http://localhost:3000.\n\n![Storefront](../../images/web.png)\n","type":"Mdx","contentDigest":"a1ac8f87f5498099da65a4e9df058ea7","counter":110,"owner":"gatsby-plugin-mdx"},"frontmatter":{"title":"Deploy Storefront (Openliberty Version) locally on your machine","description":"Instructions to deploy storefront locally"},"exports":{},"rawBody":"---\ntitle: Deploy Storefront (Openliberty Version) locally on your machine\ndescription: Instructions to deploy storefront locally\n---\n\n## Introduction\n\nStorefront is a simple shopping application that displays a catalog of antique computing devices, where users can search and buy products. It has a Web interface, and it relies on BFF (Backend for Frontend) services to interact with the backend services.\n\n## Pre-requisites:\n\n* [Appsody](https://appsody.dev/)\n  - [Installing on MacOS](https://appsody.dev/docs/installing/macos)\n  - [Installing on Windows](https://appsody.dev/docs/installing/windows)\n  - [Installing on RHEL](https://appsody.dev/docs/installing/rhel)\n  - [Installing on Ubuntu](https://appsody.dev/docs/installing/ubuntu)\n\nFor more details on installation, check [this](https://appsody.dev/docs/installing/installing-appsody/) out.\n\n* Docker Desktop\n  - [Docker for Mac](https://docs.docker.com/docker-for-mac/)\n  - [Docker for Windows](https://docs.docker.com/docker-for-windows/)\n\n* [IBM Mobile Foundation CLI](https://www.npmjs.com/package/mfpdev-cli)\n* [Ionic CLI Version 5.4.16](https://ionicframework.com/docs/cli)\n\n## Running the application locally\n\nLet us now deploy all the microservices of our storefront one by one locally.\n\n#### Deploy JAEGER\n\n- Deploy Jaeger as follows\n\n```\ndocker run -d --name jaeger   -e COLLECTOR_ZIPKIN_HTTP_PORT=9411   -p 5775:5775/udp   -p 6831:6831/udp   -p 6832:6832/udp   -p 5778:5778   -p 16686:16686   -p 14268:14268   -p 9411:9411   jaegertracing/all-in-one:1.11\n```\n\nIf it is successfully deployed, you will see something like below.\n\n```\n$ docker ps\nCONTAINER ID        IMAGE                           COMMAND                  CREATED             STATUS              PORTS                                                                                                                                                                     NAMES\ndf370368c115        jaegertracing/all-in-one:1.11   \"/go/bin/all-in-one-…\"   3 minutes ago       Up 3 minutes        0.0.0.0:5775->5775/udp, 0.0.0.0:5778->5778/tcp, 0.0.0.0:9411->9411/tcp, 0.0.0.0:14268->14268/tcp, 0.0.0.0:6831-6832->6831-6832/udp, 0.0.0.0:16686->16686/tcp, 14250/tcp   jaeger\n```\n\n### Inventory\n\n- Clone inventory repository\n\n```bash\ngit clone https://github.com/ibm-garage-ref-storefront/inventory-ms-openliberty\ncd inventory-ms-openliberty\n```\n\n#### Deploy MySQL database\n\n<br></br>\n\n```\n# Start a MySQL Container with a database user, a password, and create a new database\ndocker run --name inventorymysql \\\n    -e MYSQL_ROOT_PASSWORD=admin123 \\\n    -e MYSQL_USER=dbuser \\\n    -e MYSQL_PASSWORD=password \\\n    -e MYSQL_DATABASE=inventorydb \\\n    -p 3306:3306 \\\n    -d mysql:5.7.14\n```\n\nIf it is successfully deployed, you will see something like below.\n\n```\n$ docker ps\nCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                    NAMES\n6156756ba27c        mysql:5.7.14        \"docker-entrypoint.s…\"   5 seconds ago       Up 3 seconds        0.0.0.0:3306->3306/tcp   inventorymysql\n```\n\n- Now let us populate the MySQL with data.\n\nFirstly, `ssh` into the MySQL container.\n\n```\ndocker exec -it inventorymysql bash\n```\n\n- Now, run the below command for table creation.\n\n```\nmysql -udbuser -ppassword\n```\n\n- This will take you to something like below.\n\n```\nroot@d88a6e5973de:/# mysql -udbuser -ppassword\nmysql: [Warning] Using a password on the command line interface can be insecure.\nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 2\nServer version: 5.7.14 MySQL Community Server (GPL)\n\nCopyright (c) 2000, 2016, Oracle and/or its affiliates. All rights reserved.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nmysql>\n```\n\n- Go to `scripts > mysql_data.sql`. Copy the contents from [mysql_data.sql](https://github.com/ibm-garage-ref-storefront/inventory-ms-spring/blob/master/scripts/mysql_data.sql) and paste the contents in the console.\n\n- You can exit from the console using `exit`.\n\n```\nmysql> exit\nBye\n```\n\n- To come out of the container, enter `exit`.\n\n```\nroot@d88a6e5973de:/# exit\n```\n\n#### Deploy Inventory app\n\n<br></br>\n\nRun the below command.\n\n```\n# Build inventory docker image\nappsody build\n\n# Start the Inventory Container\ndocker run --name inventory-ms-openliberty \\\n     -e jdbcURL=jdbc:mysql://host.docker.internal:3306/inventorydb?useSSL=true \\\n     -e dbuser=dbuser \\\n     -e dbpassword=password \\\n     -e JAEGER_SERVICE_NAME=inventory-ms-openliberty \\\n     -e JAEGER_AGENT_HOST=host.docker.internal \\\n     -e JAEGER_AGENT_PORT=6831 \\\n     -e JAEGER_REPORTER_LOG_SPANS=true \\\n     -e JAEGER_REPORTER_FLUSH_INTERVAL=2000 \\\n     -e JAEGER_SAMPLER_TYPE=const \\\n     -e JAEGER_SAMPLER_PARAM=1 \\\n     -p 9081:9080 \\\n     -d dev.local/inventory-ms-openliberty\n```\n\n- You can also verify it as follows.\n\n```\n$ docker ps\nCONTAINER ID        IMAGE                                COMMAND                  CREATED             STATUS              PORTS                                                                                                                                                                     NAMES\nc83fb01c87f9        dev.local/inventory-ms-openliberty   \"/opt/ol/helpers/run…\"   About an hour ago   Up About an hour    9443/tcp, 0.0.0.0:9081->9080/tcp                                                                                                                                          inventory-ms-openliberty\ndf370368c115        jaegertracing/all-in-one:1.11        \"/go/bin/all-in-one-…\"   About an hour ago   Up About an hour    0.0.0.0:5775->5775/udp, 0.0.0.0:5778->5778/tcp, 0.0.0.0:9411->9411/tcp, 0.0.0.0:14268->14268/tcp, 0.0.0.0:6831-6832->6831-6832/udp, 0.0.0.0:16686->16686/tcp, 14250/tcp   jaeger\n6156756ba27c        mysql:5.7.14                         \"docker-entrypoint.s…\"   About an hour ago   Up About an hour    0.0.0.0:3306->3306/tcp                                                                                                                                                    inventorymysql\n```\n\n- Exit out of repo.\n\n```\ncd ..\n```\n\n### Catalog\n\n- Clone catalog repository\n\n```bash\ngit clone https://github.com/ibm-garage-ref-storefront/catalog-ms-spring.git\ncd catalog-ms-spring\n```\n\n#### Deploy ElasticSearch\n\n<br></br>\n\n```\n# Start an Elasticsearch Container\ndocker run --name catalogelasticsearch \\\n  -e \"discovery.type=single-node\" \\\n  -p 9200:9200 \\\n  -p 9300:9300 \\\n  -d docker.elastic.co/elasticsearch/elasticsearch:6.3.2\n```\n\nIf it is successfully deployed, you will see something like below.\n\n```\n$ docker ps\nCONTAINER ID        IMAGE                                                 COMMAND                  CREATED             STATUS              PORTS                                                                                                                                                                     NAMES\n07fb73eba00b        docker.elastic.co/elasticsearch/elasticsearch:6.3.2   \"/usr/local/bin/dock…\"   25 seconds ago      Up 20 seconds       0.0.0.0:9200->9200/tcp, 0.0.0.0:9300->9300/tcp                                                                                                                            catalogelasticsearch\nc83fb01c87f9        dev.local/inventory-ms-openliberty                    \"/opt/ol/helpers/run…\"   About an hour ago   Up About an hour    9443/tcp, 0.0.0.0:9081->9080/tcp                                                                                                                                          inventory-ms-openliberty\ndf370368c115        jaegertracing/all-in-one:1.11                         \"/go/bin/all-in-one-…\"   About an hour ago   Up About an hour    0.0.0.0:5775->5775/udp, 0.0.0.0:5778->5778/tcp, 0.0.0.0:9411->9411/tcp, 0.0.0.0:14268->14268/tcp, 0.0.0.0:6831-6832->6831-6832/udp, 0.0.0.0:16686->16686/tcp, 14250/tcp   jaeger\n6156756ba27c        mysql:5.7.14                                          \"docker-entrypoint.s…\"   About an hour ago   Up About an hour    0.0.0.0:3306->3306/tcp                                                                                                                                                    inventorymysql\n```\n\n#### Deploy Catalog app\n\n<br></br>\n\nRun the below command.\n\n```\n# Build catalog docker image\nappsody build\n\n# Start the Catalog Container\ndocker run --name catalog-ms-openliberty \\\n  -e elasticsearch_url=http://host.docker.internal:9200 \\\n  -e elasticsearch_index=micro \\\n  -e elasticsearch_doc_type=items \\\n  -e dev.appsody.application.client.InventoryServiceClient/mp-rest/url=http://host.docker.internal:9081/micro/inventory \\\n  -e inventory_health=http://host.docker.internal:9081/health \\\n  -e JAEGER_SERVICE_NAME=catalog-ms-openliberty \\\n  -e JAEGER_AGENT_HOST=host.docker.internal \\\n  -e JAEGER_AGENT_PORT=6831 \\\n  -e JAEGER_REPORTER_LOG_SPANS=true \\\n  -e JAEGER_REPORTER_FLUSH_INTERVAL=2000 \\\n  -e JAEGER_SAMPLER_TYPE=const \\\n  -e JAEGER_SAMPLER_PARAM=1 \\\n  -p 9082:9080 \\\n  -d dev.local/catalog-ms-openliberty\n```\n\n- You can also verify it as follows.\n\n```\n$ docker ps\nCONTAINER ID        IMAGE                                                 COMMAND                  CREATED             STATUS              PORTS                                                                                                                                                                     NAMES\n3d000493ff61        dev.local/catalog-ms-openliberty                      \"/opt/ol/helpers/run…\"   9 seconds ago       Up 8 seconds        9443/tcp, 0.0.0.0:9082->9080/tcp                                                                                                                                          catalog-ms-openliberty\n07fb73eba00b        docker.elastic.co/elasticsearch/elasticsearch:6.3.2   \"/usr/local/bin/dock…\"   31 minutes ago      Up 31 minutes       0.0.0.0:9200->9200/tcp, 0.0.0.0:9300->9300/tcp                                                                                                                            catalogelasticsearch\nc83fb01c87f9        dev.local/inventory-ms-openliberty                    \"/opt/ol/helpers/run…\"   2 hours ago         Up 2 hours          9443/tcp, 0.0.0.0:9081->9080/tcp                                                                                                                                          inventory-ms-openliberty\ndf370368c115        jaegertracing/all-in-one:1.11                         \"/go/bin/all-in-one-…\"   2 hours ago         Up 2 hours          0.0.0.0:5775->5775/udp, 0.0.0.0:5778->5778/tcp, 0.0.0.0:9411->9411/tcp, 0.0.0.0:14268->14268/tcp, 0.0.0.0:6831-6832->6831-6832/udp, 0.0.0.0:16686->16686/tcp, 14250/tcp   jaeger\n6156756ba27c        mysql:5.7.14                                          \"docker-entrypoint.s…\"   2 hours ago         Up 2 hours          0.0.0.0:3306->3306/tcp                                                                                                                                                    inventorymysql\n```\n\n- Exit out of repo.\n\n```\ncd ..\n```\n\n### Set Up Keystore\n\n- Clone the below repositories\n\n```bash\ngit clone https://github.com/ibm-garage-ref-storefront/auth-ms-openliberty.git\ngit clone https://github.com/ibm-garage-ref-storefront/customer-ms-openliberty.git\ngit clone https://github.com/ibm-garage-ref-storefront/orders-ms-openliberty.git\n```\n- Clone storefront automator\n\n```bash\ngit clone https://github.com/ibm-garage-ref-storefront/storefront-repo-automator.git\ncd storefront-repo-automator\n```\n\n- Run the below script to create necessary key store files in auth-ms-openliberty, customer-ms-openliberty, and orders-ms-openliberty\n\n```bash\n./keystore.sh\n```\n\nIf successfully created, you will see something like below.\n\n```\n$ ./keystore.sh\nKeystore type: PKCS12\nKeystore provider: SUN\n\nYour keystore contains 1 entry\n\nbckey, Nov 26, 2020, PrivateKeyEntry,\nCertificate fingerprint (SHA1): C8:60:C0:4B:8D:46:70:10:AE:6E:82:9B:61:67:C0:BD:68:42:D9:0F\nCertificate stored in file <client.cer>\nCertificate was added to keystore\n[Storing ./truststore.p12]\n```\n\n- Exit out of repo.\n\n```\ncd ..\n```\n\n### Auth\n\n- Go to auth repository\n\n```bash\ncd auth-ms-openliberty\n```\n\n#### Deploy Auth app\n\n<br></br>\n\nRun the below command.\n\n```\n# Build auth docker image\nappsody build\n\n# Start the Auth Container\ndocker run --name auth-ms-openliberty \\\n  -p 9083:9080 \\\n  -p 9444:9443 \\\n  -e jwksIssuer=\"https://localhost:9444/oidc/endpoint/OP\" \\\n  -d dev.local/auth-ms-openliberty\n```\n\n- You can also verify it as follows.\n\n```\n$ docker ps\nCONTAINER ID        IMAGE                                                 COMMAND                  CREATED             STATUS              PORTS                                                                                                                                                                     NAMES\nf27f340d270f        dev.local/auth-ms-openliberty                         \"/opt/ol/helpers/run…\"   8 seconds ago       Up 7 seconds        0.0.0.0:9083->9080/tcp, 0.0.0.0:9444->9443/tcp                                                                                                                            auth-ms-openliberty\n3d000493ff61        dev.local/catalog-ms-openliberty                      \"/opt/ol/helpers/run…\"   12 minutes ago      Up 12 minutes       9443/tcp, 0.0.0.0:9082->9080/tcp                                                                                                                                          catalog-ms-openliberty\n07fb73eba00b        docker.elastic.co/elasticsearch/elasticsearch:6.3.2   \"/usr/local/bin/dock…\"   43 minutes ago      Up 43 minutes       0.0.0.0:9200->9200/tcp, 0.0.0.0:9300->9300/tcp                                                                                                                            catalogelasticsearch\nc83fb01c87f9        dev.local/inventory-ms-openliberty                    \"/opt/ol/helpers/run…\"   2 hours ago         Up 2 hours          9443/tcp, 0.0.0.0:9081->9080/tcp                                                                                                                                          inventory-ms-openliberty\ndf370368c115        jaegertracing/all-in-one:1.11                         \"/go/bin/all-in-one-…\"   2 hours ago         Up 2 hours          0.0.0.0:5775->5775/udp, 0.0.0.0:5778->5778/tcp, 0.0.0.0:9411->9411/tcp, 0.0.0.0:14268->14268/tcp, 0.0.0.0:6831-6832->6831-6832/udp, 0.0.0.0:16686->16686/tcp, 14250/tcp   jaeger\n6156756ba27c        mysql:5.7.14                                          \"docker-entrypoint.s…\"   2 hours ago         Up 2 hours          0.0.0.0:3306->3306/tcp                                                                                                                                                    inventorymysql\n```\n\n- Exit out of repo.\n\n```\ncd ..\n```\n\n### Customer\n\n- Go to customer repository\n\n```bash\ncd customer-ms-openliberty\n```\n\n#### Deploy CouchDB\n\n<br></br>\n\n```\n# Start a CouchDB Container with a database user, a password, and create a new database\ndocker run -d -e COUCHDB_USER='admin' -e COUCHDB_PASSWORD='password' -p 5984:5984 couchdb\n```\n\nIf it is successfully deployed, you will see something like below.\n\n```\n$ docker ps\nCONTAINER ID        IMAGE                                                 COMMAND                  CREATED             STATUS              PORTS                                                                                                                                                                     NAMES\nd0f2e4491ec9        couchdb                                               \"tini -- /docker-ent…\"   7 seconds ago       Up 6 seconds        4369/tcp, 9100/tcp, 0.0.0.0:5984->5984/tcp                                                                                                                                beautiful_goldberg\nf27f340d270f        dev.local/auth-ms-openliberty                         \"/opt/ol/helpers/run…\"   2 minutes ago       Up 2 minutes        0.0.0.0:9083->9080/tcp, 0.0.0.0:9444->9443/tcp                                                                                                                            auth-ms-openliberty\n3d000493ff61        dev.local/catalog-ms-openliberty                      \"/opt/ol/helpers/run…\"   14 minutes ago      Up 14 minutes       9443/tcp, 0.0.0.0:9082->9080/tcp                                                                                                                                          catalog-ms-openliberty\n07fb73eba00b        docker.elastic.co/elasticsearch/elasticsearch:6.3.2   \"/usr/local/bin/dock…\"   45 minutes ago      Up 45 minutes       0.0.0.0:9200->9200/tcp, 0.0.0.0:9300->9300/tcp                                                                                                                            catalogelasticsearch\nc83fb01c87f9        dev.local/inventory-ms-openliberty                    \"/opt/ol/helpers/run…\"   2 hours ago         Up 2 hours          9443/tcp, 0.0.0.0:9081->9080/tcp                                                                                                                                          inventory-ms-openliberty\ndf370368c115        jaegertracing/all-in-one:1.11                         \"/go/bin/all-in-one-…\"   2 hours ago         Up 2 hours          0.0.0.0:5775->5775/udp, 0.0.0.0:5778->5778/tcp, 0.0.0.0:9411->9411/tcp, 0.0.0.0:14268->14268/tcp, 0.0.0.0:6831-6832->6831-6832/udp, 0.0.0.0:16686->16686/tcp, 14250/tcp   jaeger\n6156756ba27c        mysql:5.7.14                                          \"docker-entrypoint.s…\"   2 hours ago         Up 2 hours          0.0.0.0:3306->3306/tcp                                                                                                                                                    inventorymysql\n```\n\n- Populate the database with user information.\n\n```\ncd populate\npython3 populate.py localhost 5984\ncd ..\n```\n\n#### Deploy Customer app\n\n<br></br>\n\nRun the below command.\n\n```\n# Build customer docker image\nappsody build\n\n# Start the customer Container\ndocker run --name customer-ms-openliberty \\\n  -e jwksIssuer=\"https://localhost:9444/oidc/endpoint/OP\" \\\n  -e keystorePassword=\"password\" \\\n  -e dev.appsody.customer.client.CouchDBClientService/mp-rest/url=\"http://host.docker.internal:5984\" \\\n  -e couchuser=admin \\\n  -e couchpassword=password \\\n  -e JAEGER_SERVICE_NAME=customer-ms-openliberty \\\n  -e JAEGER_AGENT_HOST=host.docker.internal \\\n  -e JAEGER_AGENT_PORT=6831 \\\n  -e JAEGER_REPORTER_LOG_SPANS=true \\\n  -e JAEGER_REPORTER_FLUSH_INTERVAL=2000 \\\n  -e JAEGER_SAMPLER_TYPE=const \\\n  -e JAEGER_SAMPLER_PARAM=1 \\\n  -p 9085:9080 \\\n  -p 9446:9443 \\\n  -d dev.local/customer-ms-openliberty\n```\n\n- You can also verify it as follows.\n\n```\n$ docker ps\nCONTAINER ID        IMAGE                                                 COMMAND                  CREATED             STATUS              PORTS                                                                                                                                                                     NAMES\n3a6cd3a178ee        dev.local/customer-ms-openliberty                     \"/opt/ol/helpers/run…\"   5 seconds ago       Up 3 seconds        0.0.0.0:9085->9080/tcp, 0.0.0.0:9446->9443/tcp                                                                                                                            customer-ms-openliberty\nd0f2e4491ec9        couchdb                                               \"tini -- /docker-ent…\"   3 minutes ago       Up 3 minutes        4369/tcp, 9100/tcp, 0.0.0.0:5984->5984/tcp                                                                                                                                beautiful_goldberg\nf27f340d270f        dev.local/auth-ms-openliberty                         \"/opt/ol/helpers/run…\"   5 minutes ago       Up 5 minutes        0.0.0.0:9083->9080/tcp, 0.0.0.0:9444->9443/tcp                                                                                                                            auth-ms-openliberty\n3d000493ff61        dev.local/catalog-ms-openliberty                      \"/opt/ol/helpers/run…\"   17 minutes ago      Up 17 minutes       9443/tcp, 0.0.0.0:9082->9080/tcp                                                                                                                                          catalog-ms-openliberty\n07fb73eba00b        docker.elastic.co/elasticsearch/elasticsearch:6.3.2   \"/usr/local/bin/dock…\"   48 minutes ago      Up 48 minutes       0.0.0.0:9200->9200/tcp, 0.0.0.0:9300->9300/tcp                                                                                                                            catalogelasticsearch\nc83fb01c87f9        dev.local/inventory-ms-openliberty                    \"/opt/ol/helpers/run…\"   2 hours ago         Up 2 hours          9443/tcp, 0.0.0.0:9081->9080/tcp                                                                                                                                          inventory-ms-openliberty\ndf370368c115        jaegertracing/all-in-one:1.11                         \"/go/bin/all-in-one-…\"   2 hours ago         Up 2 hours          0.0.0.0:5775->5775/udp, 0.0.0.0:5778->5778/tcp, 0.0.0.0:9411->9411/tcp, 0.0.0.0:14268->14268/tcp, 0.0.0.0:6831-6832->6831-6832/udp, 0.0.0.0:16686->16686/tcp, 14250/tcp   jaeger\n6156756ba27c        mysql:5.7.14                                          \"docker-entrypoint.s…\"   2 hours ago         Up 2 hours          0.0.0.0:3306->3306/tcp                                                                                                                                                    inventorymysql\n```\n\n- Exit out of repo.\n\n```\ncd ..\n```\n\n### Orders\n\n- Go to orders repository\n\n```bash\ncd orders-ms-openliberty\n```\n\n#### Deploy Mariadb\n\n<br></br>\n\n```\n# Start a MariaDB Container with a database user, a password, and create a new database\ndocker run --name ordersmysql \\\n    -e MYSQL_ROOT_PASSWORD=admin123 \\\n    -e MYSQL_USER=dbuser \\\n    -e MYSQL_PASSWORD=password \\\n    -e MYSQL_DATABASE=ordersdb \\\n    -p 3307:3306 \\\n    -d mariadb\n```\n\nIf it is successfully deployed, you will see something like below.\n\n```\n$ docker ps\nCONTAINER ID        IMAGE                                                 COMMAND                  CREATED             STATUS              PORTS                                                                                                                                                                     NAMES\n12bfad474f24        mariadb                                               \"docker-entrypoint.s…\"   48 seconds ago      Up 45 seconds       0.0.0.0:3307->3306/tcp                                                                                                                                                    ordersmysql\n3a6cd3a178ee        dev.local/customer-ms-openliberty                     \"/opt/ol/helpers/run…\"   3 minutes ago       Up 3 minutes        0.0.0.0:9085->9080/tcp, 0.0.0.0:9446->9443/tcp                                                                                                                            customer-ms-openliberty\nd0f2e4491ec9        couchdb                                               \"tini -- /docker-ent…\"   6 minutes ago       Up 6 minutes        4369/tcp, 9100/tcp, 0.0.0.0:5984->5984/tcp                                                                                                                                beautiful_goldberg\nf27f340d270f        dev.local/auth-ms-openliberty                         \"/opt/ol/helpers/run…\"   8 minutes ago       Up 8 minutes        0.0.0.0:9083->9080/tcp, 0.0.0.0:9444->9443/tcp                                                                                                                            auth-ms-openliberty\n3d000493ff61        dev.local/catalog-ms-openliberty                      \"/opt/ol/helpers/run…\"   21 minutes ago      Up 20 minutes       9443/tcp, 0.0.0.0:9082->9080/tcp                                                                                                                                          catalog-ms-openliberty\n07fb73eba00b        docker.elastic.co/elasticsearch/elasticsearch:6.3.2   \"/usr/local/bin/dock…\"   51 minutes ago      Up 51 minutes       0.0.0.0:9200->9200/tcp, 0.0.0.0:9300->9300/tcp                                                                                                                            catalogelasticsearch\nc83fb01c87f9        dev.local/inventory-ms-openliberty                    \"/opt/ol/helpers/run…\"   2 hours ago         Up 2 hours          9443/tcp, 0.0.0.0:9081->9080/tcp                                                                                                                                          inventory-ms-openliberty\ndf370368c115        jaegertracing/all-in-one:1.11                         \"/go/bin/all-in-one-…\"   2 hours ago         Up 2 hours          0.0.0.0:5775->5775/udp, 0.0.0.0:5778->5778/tcp, 0.0.0.0:9411->9411/tcp, 0.0.0.0:14268->14268/tcp, 0.0.0.0:6831-6832->6831-6832/udp, 0.0.0.0:16686->16686/tcp, 14250/tcp   jaeger\n6156756ba27c        mysql:5.7.14                                          \"docker-entrypoint.s…\"   2 hours ago         Up 2 hours          0.0.0.0:3306->3306/tcp                                                                                                                                                    inventorymysql\n```\n\n- Create the orders table.\n\nFirstly ssh into the MySQL container.\n\n```bash\ndocker exec -it ordersmysql bash\n```\n\n- Now, run the below command for table creation.\n\n```\nmysql -udbuser -ppassword\n```\n\n- This will take you to something like below.\n\n```bash\nroot@5762edb59a86:/# mysql -udbuser -ppassword\nWelcome to the MariaDB monitor.  Commands end with ; or \\g.\nYour MariaDB connection id is 22\nServer version: 10.5.5-MariaDB-1:10.5.5+maria~focal mariadb.org binary distribution\n\nCopyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nMariaDB [(none)]>\n```\n\n- Go to scripts > [mysql_data.sql](https://github.com/ibm-garage-ref-storefront/orders-ms-openliberty/blob/master/scripts/mysql_data.sql). Copy the contents from mysql_data.sql and paste the contents in the console.\n\n- You can exit from the console using `exit`.\n\n```bash\nMariaDB [(none)]> exit\nBye\n```\n\n- To come out of the container, enter exit.\n\n```bash\nroot@5762edb59a86:/# exit\nexit\n```\n\n#### Deploy Orders app\n\n<br></br>\n\nRun the below command.\n\n```\n# Build orders docker image\nappsody build\n\n# Start the Orders Container\ndocker run --name orders-ms-openliberty \\\n  -e jdbcURL=jdbc:mysql://host.docker.internal:3307/ordersdb?useSSL=true \\\n  -e dbuser=dbuser \\\n  -e dbpassword=password \\\n  -e jwksIssuer=\"https://localhost:9444/oidc/endpoint/OP\" \\\n  -e JAEGER_SERVICE_NAME=orders-ms-openliberty \\\n  -e JAEGER_AGENT_HOST=host.docker.internal \\\n  -e JAEGER_AGENT_PORT=6831 \\\n  -e JAEGER_REPORTER_LOG_SPANS=true \\\n  -e JAEGER_REPORTER_FLUSH_INTERVAL=2000 \\\n  -e JAEGER_SAMPLER_TYPE=const \\\n  -e JAEGER_SAMPLER_PARAM=1 \\\n  -p 9084:9080 \\\n  -p 9445:9443 \\\n  -d dev.local/orders-ms-openliberty\n```\n\n- You can also verify it as follows.\n\n```\n$ docker ps\nCONTAINER ID        IMAGE                                                 COMMAND                  CREATED             STATUS              PORTS                                                                                                                                                                     NAMES\nc6ca0064e496        dev.local/orders-ms-openliberty                       \"/opt/ol/helpers/run…\"   8 seconds ago       Up 6 seconds        0.0.0.0:9084->9080/tcp, 0.0.0.0:9445->9443/tcp                                                                                                                            orders-ms-openliberty\n12bfad474f24        mariadb                                               \"docker-entrypoint.s…\"   5 hours ago         Up 5 hours          0.0.0.0:3307->3306/tcp                                                                                                                                                    ordersmysql\n3a6cd3a178ee        dev.local/customer-ms-openliberty                     \"/opt/ol/helpers/run…\"   5 hours ago         Up 5 hours          0.0.0.0:9085->9080/tcp, 0.0.0.0:9446->9443/tcp                                                                                                                            customer-ms-openliberty\nd0f2e4491ec9        couchdb                                               \"tini -- /docker-ent…\"   5 hours ago         Up 5 hours          4369/tcp, 9100/tcp, 0.0.0.0:5984->5984/tcp                                                                                                                                beautiful_goldberg\nf27f340d270f        dev.local/auth-ms-openliberty                         \"/opt/ol/helpers/run…\"   5 hours ago         Up 5 hours          0.0.0.0:9083->9080/tcp, 0.0.0.0:9444->9443/tcp                                                                                                                            auth-ms-openliberty\n3d000493ff61        dev.local/catalog-ms-openliberty                      \"/opt/ol/helpers/run…\"   5 hours ago         Up 5 hours          9443/tcp, 0.0.0.0:9082->9080/tcp                                                                                                                                          catalog-ms-openliberty\n07fb73eba00b        docker.elastic.co/elasticsearch/elasticsearch:6.3.2   \"/usr/local/bin/dock…\"   5 hours ago         Up 5 hours          0.0.0.0:9200->9200/tcp, 0.0.0.0:9300->9300/tcp                                                                                                                            catalogelasticsearch\nc83fb01c87f9        dev.local/inventory-ms-openliberty                    \"/opt/ol/helpers/run…\"   7 hours ago         Up 7 hours          9443/tcp, 0.0.0.0:9081->9080/tcp                                                                                                                                          inventory-ms-openliberty\ndf370368c115        jaegertracing/all-in-one:1.11                         \"/go/bin/all-in-one-…\"   7 hours ago         Up 7 hours          0.0.0.0:5775->5775/udp, 0.0.0.0:5778->5778/tcp, 0.0.0.0:9411->9411/tcp, 0.0.0.0:14268->14268/tcp, 0.0.0.0:6831-6832->6831-6832/udp, 0.0.0.0:16686->16686/tcp, 14250/tcp   jaeger\n6156756ba27c        mysql:5.7.14                                          \"docker-entrypoint.s…\"   7 hours ago         Up 7 hours          0.0.0.0:3306->3306/tcp                                                                                                                                                    inventorymysql\n```\n\n- Exit out of repo.\n\n```\ncd ..\n```\n\n### Storefront UI\n\n- Clone Storefront-UI repository\n\n```bash\ngit clone https://github.com/ibm-garage-ref-storefront/storefront-ui.git\ncd storefront-ui\n```\n\n#### Deploy Storefront UI\n\n<br></br>\n\nRun the below command.\n\n```\n# Build storefront ui docker image\nappsody build\n\n# Start the Storefront UI Container\ndocker run --name web \\\n  -e NODE_ENV=development \\\n  -p 3000:3000 \\\n  -d dev.local/web\n```\n\n- You can also verify it as follows.\n\n```\n$ docker ps\nCONTAINER ID        IMAGE                                                 COMMAND                  CREATED             STATUS              PORTS                                                                                                                                                                     NAMES\n60d37579ce50        dev.local/web                                         \"container-entrypoin…\"   11 seconds ago      Up 9 seconds        0.0.0.0:3000->3000/tcp, 8080/tcp                                                                                                                                          web\nc6ca0064e496        dev.local/orders-ms-openliberty                       \"/opt/ol/helpers/run…\"   14 minutes ago      Up 14 minutes       0.0.0.0:9084->9080/tcp, 0.0.0.0:9445->9443/tcp                                                                                                                            orders-ms-openliberty\n12bfad474f24        mariadb                                               \"docker-entrypoint.s…\"   5 hours ago         Up 5 hours          0.0.0.0:3307->3306/tcp                                                                                                                                                    ordersmysql\n3a6cd3a178ee        dev.local/customer-ms-openliberty                     \"/opt/ol/helpers/run…\"   5 hours ago         Up 5 hours          0.0.0.0:9085->9080/tcp, 0.0.0.0:9446->9443/tcp                                                                                                                            customer-ms-openliberty\nd0f2e4491ec9        couchdb                                               \"tini -- /docker-ent…\"   5 hours ago         Up 5 hours          4369/tcp, 9100/tcp, 0.0.0.0:5984->5984/tcp                                                                                                                                beautiful_goldberg\nf27f340d270f        dev.local/auth-ms-openliberty                         \"/opt/ol/helpers/run…\"   5 hours ago         Up 5 hours          0.0.0.0:9083->9080/tcp, 0.0.0.0:9444->9443/tcp                                                                                                                            auth-ms-openliberty\n3d000493ff61        dev.local/catalog-ms-openliberty                      \"/opt/ol/helpers/run…\"   5 hours ago         Up 5 hours          9443/tcp, 0.0.0.0:9082->9080/tcp                                                                                                                                          catalog-ms-openliberty\n07fb73eba00b        docker.elastic.co/elasticsearch/elasticsearch:6.3.2   \"/usr/local/bin/dock…\"   6 hours ago         Up 6 hours          0.0.0.0:9200->9200/tcp, 0.0.0.0:9300->9300/tcp                                                                                                                            catalogelasticsearch\nc83fb01c87f9        dev.local/inventory-ms-openliberty                    \"/opt/ol/helpers/run…\"   7 hours ago         Up 7 hours          9443/tcp, 0.0.0.0:9081->9080/tcp                                                                                                                                          inventory-ms-openliberty\ndf370368c115        jaegertracing/all-in-one:1.11                         \"/go/bin/all-in-one-…\"   7 hours ago         Up 7 hours          0.0.0.0:5775->5775/udp, 0.0.0.0:5778->5778/tcp, 0.0.0.0:9411->9411/tcp, 0.0.0.0:14268->14268/tcp, 0.0.0.0:6831-6832->6831-6832/udp, 0.0.0.0:16686->16686/tcp, 14250/tcp   jaeger\n6156756ba27c        mysql:5.7.14                                          \"docker-entrypoint.s…\"   7 hours ago         Up 7 hours          0.0.0.0:3306->3306/tcp                                                                                                                                                    inventorymysql\n```\n\nThere you go, you deploy all the necessary services for storefront.\n\nNow, let us check the app out. You can access it at http://localhost:3000.\n\n![Storefront](../../images/web.png)\n","fileAbsolutePath":"/home/travis/build/ibm-garage-ref-storefront/docs/src/pages/deployments/appsody-mp.mdx"}}}}